<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>python_tools.module_utils &mdash; python_tools 1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            python_tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">python_tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">python_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">python_tools.module_utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for python_tools.module_utils</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>



<span class="sd">Purpose: to provide functionality for inspecting,</span>
<span class="sd">editing and interacting with python modules (the .py files)</span>



<span class="sd">Note: </span>

<span class="sd">---Default arguments:---</span>
<span class="sd">Default arguments of a function only get initialized once, so if made</span>
<span class="sd">default arguments equal to a global value then would only take on the</span>
<span class="sd">default value of the global value that was there at the very beginning</span>

<span class="sd">Solution: Make equal to None and then set it equal to the global</span>
<span class="sd">value inside the funciton</span>

<span class="sd">---- using eval and exec ----</span>
<span class="sd">Rule: Can&#39;t set </span>





<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">regex</span> <span class="k">as</span> <span class="nn">re</span>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Demo: Shows that you can&#39;t set a local variable with exec and eval </span>

<span class="sd">x_global = 100</span>
<span class="sd">y_global = 200</span>

<span class="sd">def my_func(x = 2,y=None):</span>
<span class="sd">    inspect_elem = inspect.getargspec(my_func)</span>
<span class="sd">    for arg in inspect_elem.args:</span>
<span class="sd">        print(eval(arg))</span>
<span class="sd">        if eval(arg) is None:</span>
<span class="sd">            </span>
<span class="sd">            print(f&quot;{arg} is None&quot;)</span>
<span class="sd">            command = f&quot;{arg} = {arg}_global&quot;</span>
<span class="sd">            print(f&quot;{command}&quot;)</span>
<span class="sd">            exec(f&quot;{command}&quot;)</span>
<span class="sd">            </span>
<span class="sd">    print(f&quot;x = {x}, y = {y}&quot;)</span>



<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="options"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.options">[docs]</a><span class="k">class</span> <span class="nc">options</span><span class="p">:</span>
<div class="viewcode-block" id="options.__init__"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.options.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">directional</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directional</span>
        <span class="n">f</span><span class="o">.</span><span class="n">multiedge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiedge</span>
        <span class="k">return</span> <span class="n">f</span></div>



<span class="n">global_ending</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>
<span class="n">output_types_global</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;global_parameters&quot;</span><span class="p">,</span><span class="s2">&quot;attributes&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="basic_global_names"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.basic_global_names">[docs]</a><span class="k">def</span> <span class="nf">basic_global_names</span><span class="p">(</span><span class="n">k</span><span class="p">,</span>
                       <span class="n">global_suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">suffix_to_add</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">global_suffix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">global_suffix</span> <span class="o">=</span> <span class="n">global_ending</span>
    <span class="k">if</span> <span class="n">suffix_to_add</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">global_suffix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix_to_add</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">global_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">global_suffix</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">k</span><span class="p">,</span><span class="n">k</span>
        
    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">global_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span>
        <span class="n">basic_name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">global_name</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">basic_name</span> <span class="o">=</span> <span class="n">k</span>
        <span class="n">global_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">global_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        
    <span class="k">return</span> <span class="n">basic_name</span><span class="p">,</span><span class="n">global_name</span></div>

<div class="viewcode-block" id="generate_None_assignment_block"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.generate_None_assignment_block">[docs]</a><span class="k">def</span> <span class="nf">generate_None_assignment_block</span><span class="p">(</span><span class="n">param_dict</span><span class="p">,</span>
                                  <span class="n">suffix_to_filter_away</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">suffix_to_add</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">basic_name</span><span class="p">,</span><span class="n">global_name</span> <span class="o">=</span> <span class="n">basic_global_names</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">suffix_to_add</span><span class="o">=</span><span class="n">suffix_to_add</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">suffix_to_filter_away</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">curr_idx</span> <span class="o">=</span> <span class="n">basic_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">suffix_to_filter_away</span><span class="p">)</span>
            <span class="n">basic_name</span><span class="o">=</span> <span class="n">basic_name</span><span class="p">[:</span><span class="n">curr_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;if </span><span class="si">{</span><span class="n">basic_name</span><span class="si">}</span><span class="s2"> is None:</span><span class="se">\n</span><span class="s2">    </span><span class="si">{</span><span class="n">basic_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">global_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="generate_default_assignment_block"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.generate_default_assignment_block">[docs]</a><span class="k">def</span> <span class="nf">generate_default_assignment_block</span><span class="p">(</span><span class="n">param_dict</span><span class="p">,</span><span class="n">include</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">basic_name</span><span class="p">,</span><span class="n">global_name</span> <span class="o">=</span> <span class="n">basic_global_names</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">global_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="print_dict_with_suffix"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.print_dict_with_suffix">[docs]</a><span class="k">def</span> <span class="nf">print_dict_with_suffix</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span><span class="n">suffix</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="set_global_parameters_by_dict"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.set_global_parameters_by_dict">[docs]</a><span class="k">def</span> <span class="nf">set_global_parameters_by_dict</span><span class="p">(</span><span class="n">module</span><span class="p">,</span>
                                  <span class="n">param_dict</span><span class="p">,</span>
                           <span class="n">global_suffix</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span>
                          <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">local_name</span><span class="p">,</span><span class="n">global_name</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">basic_global_names</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">global_suffix</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">global_name</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to set </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">global_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">global_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="set_attributes_by_dict"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.set_attributes_by_dict">[docs]</a><span class="k">def</span> <span class="nf">set_attributes_by_dict</span><span class="p">(</span><span class="n">module</span><span class="p">,</span>
                           <span class="n">param_dict</span><span class="p">,</span>
                           <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">global_suffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">local_name</span><span class="p">,</span><span class="n">global_name</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">basic_global_names</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">global_suffix</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">global_name</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to set </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">global_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">global_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
            
            
<div class="viewcode-block" id="collect_global_parameters_and_attributes_by_data_type"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.collect_global_parameters_and_attributes_by_data_type">[docs]</a><span class="k">def</span> <span class="nf">collect_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
    <span class="n">module</span><span class="p">,</span>
    <span class="n">data_type</span><span class="p">,</span>
    <span class="n">include_default</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">algorithms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_types</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">algorithms_only</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PUrpose: To compile the dictionary to either</span>
<span class="sd">    set or output</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">algorithms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">algorithms</span><span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">convert_to_array_like</span><span class="p">(</span><span class="n">algorithms</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">algorithms</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">if</span> <span class="n">output_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_types</span> <span class="o">=</span> <span class="n">output_types_global</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">output_types</span><span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">convert_to_array_like</span><span class="p">(</span><span class="n">output_types</span><span class="p">)</span>
        
        
    
    <span class="n">p_list</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="n">include_default</span> <span class="ow">and</span> <span class="n">data_type</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">total_data_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">,</span><span class="n">data_type</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">total_data_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_type</span><span class="p">]</span>
    
    
    <span class="k">for</span> <span class="n">dict_type</span> <span class="ow">in</span> <span class="n">output_types</span><span class="p">:</span>
        <span class="n">p_list</span><span class="p">[</span><span class="n">dict_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="n">total_data_types</span><span class="p">:</span>

            <span class="n">dict_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dict_type</span><span class="si">}</span><span class="s2">_dict_</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&quot;</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">algorithms_only</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">curr_dict</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">dict_name</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown dict_name = </span><span class="si">{</span><span class="n">dict_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collecting </span><span class="si">{</span><span class="n">dict_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;curr_dict = </span><span class="si">{</span><span class="n">curr_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">p_list</span><span class="p">[</span><span class="n">dict_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_dict</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">alg</span> <span class="ow">in</span> <span class="n">algorithms</span><span class="p">:</span>
<span class="c1">#                 if data_type == &quot;default&quot;:</span>
<span class="c1">#                     break</span>
                <span class="n">dict_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dict_type</span><span class="si">}</span><span class="s2">_dict_</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">alg</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">curr_dict</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">dict_name</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown dict_name = </span><span class="si">{</span><span class="n">dict_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collecting </span><span class="si">{</span><span class="n">dict_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;curr_dict = </span><span class="si">{</span><span class="n">curr_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">p_list</span><span class="p">[</span><span class="n">dict_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_dict</span><span class="p">)</span>
    
    <span class="c1">#compiling all the dicts</span>
    <span class="k">if</span> <span class="s2">&quot;global_parameters&quot;</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
        <span class="n">global_parameters_dict</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">p_list</span><span class="p">[</span><span class="s2">&quot;global_parameters&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">global_parameters_dict</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">if</span> <span class="s2">&quot;attributes&quot;</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
        <span class="n">attributes_dict</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">p_list</span><span class="p">[</span><span class="s2">&quot;attributes&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">attributes_dict</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">return</span> <span class="n">global_parameters_dict</span><span class="p">,</span><span class="n">attributes_dict</span></div>
    
<div class="viewcode-block" id="extract_module_algorithm"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.extract_module_algorithm">[docs]</a><span class="k">def</span> <span class="nf">extract_module_algorithm</span><span class="p">(</span><span class="n">module</span><span class="p">,</span>
                             <span class="n">return_parameters</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Will extract which model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">module</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">algorithms sent in dict&quot;</span><span class="p">)</span>
        <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;algorithms&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">module</span><span class="p">[</span><span class="s2">&quot;module&quot;</span><span class="p">]</span>
        <span class="n">algorithms_only</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">elif</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">include_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">algorithms sent in array&quot;</span><span class="p">)</span>
        <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">module</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">module</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">algorithms_only</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No algorithms per module set&quot;</span><span class="p">)</span>
        <span class="n">algorithms_local</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">algorithms_only</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">if</span> <span class="n">return_parameters</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">module</span><span class="p">,</span><span class="n">algorithms_local</span><span class="p">,</span><span class="n">algorithms_only</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">module</span><span class="p">,</span><span class="n">algorithms_local</span></div>
    

<div class="viewcode-block" id="set_global_parameters_and_attributes_by_data_type"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.set_global_parameters_and_attributes_by_data_type">[docs]</a><span class="k">def</span> <span class="nf">set_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
    <span class="n">module</span><span class="p">,</span>
    <span class="n">data_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">algorithms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">set_default_first</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
    
<span class="c1">#     if set_default_first and data_type != &quot;default&quot;:</span>
<span class="c1">#         if verbose:</span>
<span class="c1">#             print(f&quot;Setting default first&quot;)</span>
<span class="c1">#         modu.set_global_parameters_and_attributes_by_data_type(module,</span>
<span class="c1">#                                                                data_type=&quot;default&quot;,</span>
<span class="c1">#                                                               set_default_first = False,</span>
<span class="c1">#                                                               verbose = False)</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
    
    <span class="n">module_list</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">convert_to_array_like</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">module_list</span><span class="p">:</span>
            
        <span class="n">module</span><span class="p">,</span> <span class="n">algorithms_local</span><span class="p">,</span> <span class="n">algorithms_only</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">extract_module_algorithm</span><span class="p">(</span>
        <span class="n">module</span><span class="p">,</span>
        <span class="n">return_parameters</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">algorithms_local</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">algorithms</span>
            
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting data type dicts for module </span><span class="si">{</span><span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;with data_type = </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">, algorithms = </span><span class="si">{</span><span class="n">algorithms_local</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">global_parameters_dict</span><span class="p">,</span>
        <span class="n">attributes_dict</span><span class="p">)</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">collect_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="n">algorithms</span><span class="o">=</span><span class="n">algorithms_local</span><span class="p">,</span>
        <span class="n">include_default</span> <span class="o">=</span> <span class="n">set_default_first</span><span class="p">,</span>
        <span class="n">algorithms_only</span> <span class="o">=</span> <span class="n">algorithms_only</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="p">)</span>
        <span class="n">module</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="n">data_type</span>
        <span class="n">module</span><span class="o">.</span><span class="n">algorithms</span> <span class="o">=</span> <span class="n">algorithms_local</span>
        <span class="n">modu</span><span class="o">.</span><span class="n">set_global_parameters_by_dict</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">global_parameters_dict</span><span class="p">)</span>
        <span class="n">modu</span><span class="o">.</span><span class="n">set_attributes_by_dict</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">attributes_dict</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--After Setting global parameters and attributes --&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">module_list</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">extract_module_algorithm</span><span class="p">(</span>
                <span class="n">m</span><span class="p">,</span>
                <span class="n">return_parameters</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   module </span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: data_type = </span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">data_type</span><span class="si">}</span><span class="s2">, algorithms = </span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">algorithms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<span class="w">        </span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">-----Example of how to use global parameters from synapse_utils-----</span>

<span class="sd">    attributes_dict_microns = dict(</span>
<span class="sd">        voxel_to_nm_scaling = alu.voxel_to_nm_scaling,</span>
<span class="sd">        data_fetcher = du</span>
<span class="sd">    )    </span>

<span class="sd">    global_parameters_dict_microns = dict()</span>

<span class="sd">    attributes_dict_h01 = dict(</span>
<span class="sd">        voxel_to_nm_scaling = hu.voxel_to_nm_scaling,</span>
<span class="sd">        data_fetcher = hdju</span>
<span class="sd">    )</span>

<span class="sd">    global_parameters_dict_h01 = dict()</span>


<span class="sd">    def set_global_parameters_and_attributes_by_data_type(data_type):</span>
<span class="sd">        from python_tools import module_utils as modu </span>
<span class="sd">        modu.set_global_parameters_and_attributes_by_data_type(syu,data_type)</span>

<span class="sd">    set_global_parameters_and_attributes_by_data_type(&quot;microns&quot;)</span>

<span class="sd">&quot;&quot;&quot;</span>



<div class="viewcode-block" id="output_global_parameters_and_attributes_from_current_data_type"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.output_global_parameters_and_attributes_from_current_data_type">[docs]</a><span class="k">def</span> <span class="nf">output_global_parameters_and_attributes_from_current_data_type</span><span class="p">(</span>
    <span class="n">module</span><span class="p">,</span>
    <span class="n">algorithms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">lowercase</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_types</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;global_parameters&quot;</span><span class="p">),</span>
    <span class="n">include_default</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">algorithms_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">abbreviate_keywords</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="n">output_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_types</span> <span class="o">=</span> <span class="n">output_types_global</span>
    
    <span class="n">module_list</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">convert_to_array_like</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="n">total_dict_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">module_list</span><span class="p">:</span>
        
        <span class="n">module</span><span class="p">,</span> <span class="n">algorithms_local</span><span class="p">,</span> <span class="n">algorithms_only_local</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">extract_module_algorithm</span><span class="p">(</span>
        <span class="n">module</span><span class="p">,</span>
        <span class="n">return_parameters</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">algorithms_local</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">algorithms</span>
            
        <span class="k">if</span> <span class="n">algorithms_only_local</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms_only_local</span> <span class="o">=</span> <span class="n">algorithms_only</span>

        <span class="n">data_type</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">data_type</span>
        
        <span class="k">if</span> <span class="n">algorithms_local</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms_local</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">algorithms</span>
            
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module: </span><span class="si">{</span><span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> data_type set to </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">, algorithms = </span><span class="si">{</span><span class="n">algorithms_local</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            

        <span class="p">(</span><span class="n">global_parameters_dict</span><span class="p">,</span>
        <span class="n">attributes_dict</span><span class="p">)</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">collect_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="n">algorithms</span><span class="o">=</span><span class="n">algorithms_local</span><span class="p">,</span>
        <span class="n">include_default</span> <span class="o">=</span> <span class="n">include_default</span><span class="p">,</span>
        <span class="n">output_types</span><span class="o">=</span><span class="n">output_types</span><span class="p">,</span>
        <span class="n">algorithms_only</span> <span class="o">=</span> <span class="n">algorithms_only_local</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="p">)</span>

        <span class="n">total_dict</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">([</span><span class="n">global_parameters_dict</span><span class="p">,</span><span class="n">attributes_dict</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">lowercase</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">total_dict</span><span class="p">,</span><span class="n">dsu</span><span class="o">.</span><span class="n">DictType</span><span class="p">):</span>
                <span class="n">total_dict</span> <span class="o">=</span> <span class="n">total_dict</span><span class="o">.</span><span class="n">lowercase</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">total_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">total_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            
        <span class="n">total_dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_dict</span><span class="p">)</span>
        
    <span class="n">final_dict</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">total_dict_list</span><span class="p">)</span>    
    
    <span class="k">return</span> <span class="n">final_dict</span></div>


<div class="viewcode-block" id="ModuleDataTypeSetter"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.ModuleDataTypeSetter">[docs]</a><span class="k">class</span> <span class="nc">ModuleDataTypeSetter</span><span class="p">:</span>
<div class="viewcode-block" id="ModuleDataTypeSetter.__init__"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.ModuleDataTypeSetter.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">algorithms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span> <span class="o">=</span> <span class="n">algorithms</span></div>

<div class="viewcode-block" id="ModuleDataTypeSetter.set_global_parameters_and_attributes_by_data_type"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.ModuleDataTypeSetter.set_global_parameters_and_attributes_by_data_type">[docs]</a>    <span class="k">def</span> <span class="nf">set_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">module</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">algorithms</span> <span class="o">=</span>  <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
        
        <span class="k">if</span> <span class="n">module</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
        <span class="k">if</span> <span class="n">algorithms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span>
            
        <span class="k">return</span> <span class="n">modu</span><span class="o">.</span><span class="n">set_global_parameters_and_attributes_by_data_type</span><span class="p">(</span>
            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
            <span class="n">algorithms</span> <span class="o">=</span> <span class="n">algorithms</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>
    
<div class="viewcode-block" id="ModuleDataTypeSetter.output_global_parameters_and_attributes_from_current_data_type"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.ModuleDataTypeSetter.output_global_parameters_and_attributes_from_current_data_type">[docs]</a>    <span class="k">def</span> <span class="nf">output_global_parameters_and_attributes_from_current_data_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">module</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">algorithms</span> <span class="o">=</span>  <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
        
        <span class="k">if</span> <span class="n">module</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
        <span class="k">if</span> <span class="n">algorithms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">algorithms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span>
            
        <span class="k">return</span> <span class="n">modu</span><span class="o">.</span><span class="n">output_global_parameters_and_attributes_from_current_data_type</span><span class="p">(</span>
            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
            <span class="n">algorithms</span> <span class="o">=</span> <span class="n">algorithms</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div></div>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">        </span>
<span class="w">        </span>



<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example of the fresh module functions:</span>


<span class="sd"># ------------- parameters for stats ---------------</span>

<span class="sd">global_parameters_dict_default = dict()</span>
<span class="sd">attributes_dict_default = dict()    </span>


<span class="sd"># ------- microns -----------</span>
<span class="sd">global_parameters_dict_microns = {}</span>
<span class="sd">attributes_dict_microns = {}</span>


<span class="sd"># --------- h01 -------------</span>
<span class="sd">global_parameters_dict_h01 = dict()</span>
<span class="sd">attributes_dict_h01 = dict()</span>



<span class="sd">data_type = &quot;default&quot;</span>
<span class="sd">algorithms = None</span>
<span class="sd">modules_to_set = [gf]</span>

<span class="sd">def set_global_parameters_and_attributes_by_data_type(dt,</span>
<span class="sd">                                                     algorithms_list = None,</span>
<span class="sd">                                                      modules = None,</span>
<span class="sd">                                                     set_default_first = True,</span>
<span class="sd">                                                      verbose=False):</span>
<span class="sd">    if modules is None:</span>
<span class="sd">        modules = modules_to_set</span>
<span class="sd">    </span>
<span class="sd">    modu.set_global_parameters_and_attributes_by_data_type(modules,dt,</span>
<span class="sd">                                                          algorithms=algorithms_list,</span>
<span class="sd">                                                          set_default_first = set_default_first,</span>
<span class="sd">                                                          verbose = verbose)</span>
<span class="sd">    </span>
<span class="sd">set_global_parameters_and_attributes_by_data_type(data_type,</span>
<span class="sd">                                                   algorithms)</span>

<span class="sd">def output_global_parameters_and_attributes_from_current_data_type(</span>
<span class="sd">    modules = None,</span>
<span class="sd">    algorithms = None,</span>
<span class="sd">    verbose = True,</span>
<span class="sd">    lowercase = True,</span>
<span class="sd">    output_types = (&quot;global_parameters&quot;),</span>
<span class="sd">    include_default = True,</span>
<span class="sd">    algorithms_only = False,</span>
<span class="sd">    **kwargs):</span>
<span class="sd">    </span>
<span class="sd">    if modules is None:</span>
<span class="sd">        modules = modules_to_set</span>
<span class="sd">    </span>
<span class="sd">    return modu.output_global_parameters_and_attributes_from_current_data_type(</span>
<span class="sd">        modules,</span>
<span class="sd">        algorithms = algorithms,</span>
<span class="sd">        verbose = verbose,</span>
<span class="sd">        lowercase = lowercase,</span>
<span class="sd">        output_types = output_types,</span>
<span class="sd">        include_default = include_default,</span>
<span class="sd">        algorithms_only = algorithms_only,</span>
<span class="sd">        **kwargs,</span>
<span class="sd">        )</span>



<span class="sd">Example on how to output: </span>
<span class="sd">kwargs_dict = gu.merge_dicts([</span>
<span class="sd">    ctu.output_global_parameters_and_attributes_from_current_data_type(),</span>
<span class="sd">    au.output_global_parameters_and_attributes_from_current_data_type(),</span>
<span class="sd">    spu.output_global_parameters_and_attributes_from_current_data_type(</span>
<span class="sd">        algorithms = [&quot;head_neck_shaft&quot;],</span>
<span class="sd">        include_default=True,</span>
<span class="sd">        algorithms_only = True),</span>
<span class="sd">    syu.output_global_parameters_and_attributes_from_current_data_type()</span>

<span class="sd">])</span>



<span class="sd">Example of how to do abridge</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="all_modules_set_global_parameters_and_attributes"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.all_modules_set_global_parameters_and_attributes">[docs]</a><span class="k">def</span> <span class="nf">all_modules_set_global_parameters_and_attributes</span><span class="p">(</span>
    <span class="n">data_type</span><span class="p">,</span>
    <span class="n">directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/meshAfterParty/meshAfterParty&quot;</span><span class="p">),</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose_loop</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To set the global parameters</span>
<span class="sd">    of all modules in a certain directory</span>
<span class="sd">    </span>
<span class="sd">    Ex: </span>
<span class="sd">    from python_tools import module_utils as modu</span>
<span class="sd">    modu.all_modules_set_global_parameters_and_attributes(</span>
<span class="sd">        &quot;microns&quot;,</span>
<span class="sd">        verbose = True,</span>
<span class="sd">    )</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/meshAfterParty/meshAfterParty&quot;</span><span class="p">)</span>
    <span class="n">mods</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">]</span>
    <span class="n">mods_set</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">mods</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose_loop</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--Working on module </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">--&quot;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;import </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose_loop</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accomplished import&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose_loop</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed import &quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">success_set</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">.set_global_parameters_and_attributes_by_data_type(data_type=&#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">.set_global_parameters_and_attributes_by_data_type(dt=&#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose_loop</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed setting plobal params &quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">success_set</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">success_set</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">verbose_loop</span> <span class="ow">or</span> <span class="n">verbose</span><span class="p">)</span> <span class="ow">and</span> <span class="n">success_set</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accomplished setting global parameters&quot;</span><span class="p">)</span>
            <span class="n">mods_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All modules set: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mods_set</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

            
<span class="c1"># ----------- more general module functions</span>

<div class="viewcode-block" id="multiline_str_text"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.multiline_str_text">[docs]</a><span class="k">def</span> <span class="nf">multiline_str_text</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To extract the inside string from a multiline str regex.Match object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="multiline_str"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.multiline_str">[docs]</a><span class="k">def</span> <span class="nf">multiline_str</span><span class="p">(</span>
    <span class="n">filepath</span><span class="p">,</span>
    <span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_text</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">above_first_func_def</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: find multiline strings in a module</span>
<span class="sd">    </span>
<span class="sd">    Ex: </span>
<span class="sd">    multiline_str(</span>
<span class="sd">        filepath = &quot;/python_tools/python_tools/example_re.py&quot;,</span>
<span class="sd">        verbose = True</span>
<span class="sd">    )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">multiline_str_pattern</span>
    <span class="k">if</span> <span class="n">beginning_of_line</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span> <span class="o">+</span> <span class="n">pattern</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">pattern</span><span class="p">,</span>
        <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span>
    <span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="n">total_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">above_first_func_def</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">index_of_first_func_def</span><span class="p">(</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">total_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">total_results</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">end</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">idx</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">return_text</span><span class="p">:</span>
        <span class="n">total_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiline_str_text</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">total_results</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of multi-line strings = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">total_results</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_results</span></div>





<div class="viewcode-block" id="import_pattern_str"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.import_pattern_str">[docs]</a><span class="k">def</span> <span class="nf">import_pattern_str</span><span class="p">(</span>
    <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_possible_comma</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="n">add_possible_comma</span><span class="p">:</span>
        <span class="n">word_comb</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">word_pattern_comma_space_numb</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">word_comb</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">word_pattern</span>
    
    
    <span class="k">if</span> <span class="n">modules</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modules</span> <span class="o">=</span> <span class="n">word_comb</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">modules</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
    
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">beginning_of_line</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
    <span class="n">import_str</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">(&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(?:import </span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;|(?:from </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;|(?:import </span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;|(?:from </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2">)&quot;</span>  
        <span class="sa">f</span><span class="s2">&quot;|(?:from [.]+</span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;import_str = </span><span class="si">{</span><span class="n">import_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">import_str</span></div>

<div class="viewcode-block" id="find_import_modules_in_file"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.find_import_modules_in_file">[docs]</a><span class="k">def</span> <span class="nf">find_import_modules_in_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unique</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose_import_pattern</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Find all imports (optionally outside of functions)</span>
<span class="sd">    in a file and create a list (most likely unique)</span>

<span class="sd">    Pseudocode: </span>
<span class="sd">    1) read in file data</span>
<span class="sd">    2) create the pattern to recognize imports</span>
<span class="sd">    3) add the newline if only care about newline</span>
<span class="sd">    4) Search string for all matches</span>
<span class="sd">    5) Create a list (maybe unique)</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1">#1) read in file data</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        
    <span class="c1">#2) create the pattern to recognize imports</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">import_pattern_str</span><span class="p">(</span>
            <span class="n">modules</span><span class="o">=</span><span class="n">modules</span><span class="p">,</span>
            <span class="n">beginning_of_line</span><span class="o">=</span><span class="n">beginning_of_line</span><span class="p">,</span>
            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose_import_pattern</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
    <span class="n">finds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="n">data</span><span class="p">))</span>

    <span class="n">str_finds</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">start</span><span class="p">():</span><span class="n">f</span><span class="o">.</span><span class="n">end</span><span class="p">()]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">finds</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">unique</span><span class="p">:</span>
        <span class="n">str_finds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">str_finds</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of matches (unique = </span><span class="si">{</span><span class="n">unique</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">str_finds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">str_finds</span></div>

<span class="c1">#from pathlib import Path</span>
<span class="c1">#import numpy as np</span>
<div class="viewcode-block" id="clean_module_imports"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.clean_module_imports">[docs]</a><span class="k">def</span> <span class="nf">clean_module_imports</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">overwrite_file</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">relative_package</span> <span class="o">=</span> <span class="s2">&quot;python_tools&quot;</span><span class="p">,</span>
    <span class="n">relative_replacement</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Want to get all of the modules importing in file</span>
<span class="sd">    (could then make a unique list and change) certain </span>
<span class="sd">    ones to newline</span>

<span class="sd">    -- then put at the top</span>

<span class="sd">    Pseudocode: </span>
<span class="sd">    1) find all statements where import is at the beginning of the line</span>
<span class="sd">    -&gt; either from [] or import</span>
<span class="sd">    2) Extract the modules and the from for all</span>
<span class="sd">    3) Create a unique list</span>
<span class="sd">    4) Replace any requested modules in from [] with another prefix</span>
<span class="sd">    5) That is list need to copy and paste at top</span>
<span class="sd">    6) Comment all of the rest out</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">curr_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>

    <span class="c1">#1-3) Create a unique list</span>
    <span class="n">finds</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">find_import_modules_in_file</span><span class="p">(</span>
        <span class="n">filename</span>  <span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">finds_top</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">finds</span> <span class="k">if</span> <span class="n">curr_file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>
    <span class="n">ending_import</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">finds</span> <span class="k">if</span> <span class="n">curr_file</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>

    <span class="c1">#6) Comment all of the rest out</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">file_regex_replace</span><span class="p">(</span>
        <span class="n">filepath</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">import_pattern_str</span><span class="p">(</span><span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
        <span class="n">replacement</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">#&quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\1&quot;</span><span class="p">,</span>
        <span class="n">overwrite_file</span> <span class="o">=</span> <span class="n">overwrite_file</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">relative_package</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#4) Replace any requested modules in from [] with another prefix</span>
        <span class="n">finds_top</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">relative_package</span><span class="p">,</span><span class="n">relative_replacement</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">else</span>
                     <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">relative_package</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">finds_top</span><span class="p">]</span>
        
        <span class="n">ending_import</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">relative_package</span><span class="p">,</span><span class="n">relative_replacement</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ending_import</span><span class="p">]</span>

    <span class="n">finds_top</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">finds_top</span><span class="p">))</span>
    <span class="c1">#5) That is list need to copy and paste at top</span>
    <span class="n">finds_top_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">finds_top</span><span class="p">)</span>
    <span class="n">ending_import</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ending_import</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
    <span class="n">filu</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">finds_top_str</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">data</span> <span class="o">+</span> <span class="n">ending_import</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_file</span></div>

<div class="viewcode-block" id="modules_from_directory"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.modules_from_directory">[docs]</a><span class="k">def</span> <span class="nf">modules_from_directory</span><span class="p">(</span>
    <span class="n">directory</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ignore_files</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;__init__&quot;</span><span class="p">,),</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Get all modules from directory</span>

<span class="sd">    Pseudocode:</span>
<span class="sd">    1) Get all of the py files in folder</span>
<span class="sd">    2) ignore the </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">files_of_ext_type</span><span class="p">(</span>
                        <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span><span class="p">,</span>
                        <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;py&quot;</span><span class="p">,</span>
                        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span>

    <span class="n">modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">modules</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">stem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_files</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of modules = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">modules</span></div>


<div class="viewcode-block" id="index_of_first_func_def"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.index_of_first_func_def">[docs]</a><span class="k">def</span> <span class="nf">index_of_first_func_def</span><span class="p">(</span>
    <span class="n">string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Want to identify location of the first</span>
<span class="sd">    function definition</span>

<span class="sd">    Application: </span>
<span class="sd">    1) only keep docstrings above the first function</span>
<span class="sd">    -&gt; would eliminate the possibility of copying a function that is commented out</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">string</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    
    <span class="n">pattern</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span><span class="si">}</span><span class="s2">def &quot;</span><span class="p">)</span>
    <span class="n">curr_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="n">string</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">curr_match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">curr_match</span> <span class="o">=</span> <span class="n">curr_match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">curr_match</span></div>



<div class="viewcode-block" id="clean_module_syntax"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.clean_module_syntax">[docs]</a><span class="k">def</span> <span class="nf">clean_module_syntax</span><span class="p">(</span>
    <span class="n">filepath</span><span class="p">,</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">non_overwrite_suffix</span> <span class="o">=</span> <span class="s2">&quot;_replaced&quot;</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">packages</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">docstring_only_above_first_func_def</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">prefix_separator</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">skip_overwrite_suffix_files</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part 0: Copy and paste document into new file if not overwrite</span>

<span class="sd">    Part 1: </span>

<span class="sd">    Purpose: How to collect and rename the packages</span>


<span class="sd">    easy: these would just neeed to collect everything after the import statement</span>
<span class="sd">    f&quot;(?:import {modules} as {word_comb})&quot;</span>
<span class="sd">    f&quot;|(?:from {word_comb} import {modules} as {word_comb})&quot;</span>
<span class="sd">    f&quot;|(?:import {modules})&quot;</span>
<span class="sd">    f&quot;|(?:from {word_comb} import {modules})&quot;  </span>

<span class="sd">    harder: need to collect everything after the dot (add prefix with no space beforehand</span>
<span class="sd">    f&quot;|(?:from [.]*{modules} import {word_comb})&quot;</span>

<span class="sd">    Process for replacement:</span>
<span class="sd">    for each package</span>
<span class="sd">    1) find and replace the easy with (everything after import grouped)</span>
<span class="sd">    with &quot;from package \1&quot;</span>
<span class="sd">    2) find and replace the harder with (everything grouped after the dot)</span>
<span class="sd">    with &quot;from package.\1&quot;</span>
<span class="sd">    -- now for the relative replacement</span>
<span class="sd">    1) find and replace the easy (at the beginning of a line) by replacing</span>
<span class="sd">    from package with from [relative dots]</span>
<span class="sd">    2) find and replace hard (at beginning of the line) by replacing</span>
<span class="sd">    from package. with [relative dots]</span>

<span class="sd">    Part 2: Organization</span>

<span class="sd">    2) Get all the docstrings and replace in the file with nothing</span>
<span class="sd">    3) Find all of the module at the beginning of the line and replace with nothing</span>
<span class="sd">    (collect for organizing later)</span>


<span class="sd">    modules_dir = modu.find_import_modules_in_file(</span>
<span class="sd">        filepath,</span>
<span class="sd">        modules = modules,</span>
<span class="sd">        beginning_of_line = False</span>
<span class="sd">        )</span>
<span class="sd">    modules_dir</span>

<span class="sd">    4) Sort the modules into relative and not relative and itself</span>
<span class="sd">    5) Write the doc string and non-referencing modules </span>
<span class="sd">    6) write last the referencing modules and then itself</span>

<span class="sd">    doc strings</span>
<span class="sd">    non-referencing modules</span>
<span class="sd">    #local veraibles</span>
<span class="sd">    rest of code</span>
<span class="sd">    referencing modules</span>
<span class="sd">    itself</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">skip_overwrite_suffix_files</span> <span class="ow">and</span> <span class="n">non_overwrite_suffix</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="k">return</span> 
    
    
    <span class="k">if</span> <span class="n">packages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">packages</span> <span class="o">=</span> <span class="n">pku</span><span class="o">.</span><span class="n">user_packages</span>
    
    
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="c1"># 0) Create the output path (or set it to current path if overwrite)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="n">filepath</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filepath</span><span class="o">.</span><span class="n">stem</span><span class="si">}{</span><span class="n">non_overwrite_suffix</span><span class="si">}{</span><span class="n">filepath</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">su</span><span class="o">.</span><span class="n">copy_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="n">output_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="n">filepath</span>

    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;output_path = </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        
    <span class="c1"># 1) Get all the information for the current module and all possible modules from all packages</span>
    <span class="n">curr_mod</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">curr_package_name</span> <span class="o">=</span> <span class="n">pku</span><span class="o">.</span><span class="n">package_from_filepath_and_package_list</span><span class="p">(</span>
        <span class="n">filepath</span><span class="o">=</span><span class="n">filepath</span><span class="p">,</span>
        <span class="n">packages</span><span class="o">=</span><span class="n">packages</span><span class="p">,</span>
        <span class="n">return_package_name</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;curr_mod = </span><span class="si">{</span><span class="n">curr_mod</span><span class="si">}</span><span class="s2">, curr_package_name = </span><span class="si">{</span><span class="n">curr_package_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        
    <span class="n">pkg_to_module</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">pku</span><span class="o">.</span><span class="n">package_name_from_path</span><span class="p">(</span><span class="n">k</span><span class="p">):</span><span class="n">pku</span><span class="o">.</span><span class="n">module_names_from_directories</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">packages</span>
    <span class="p">}</span>
    
    
    <span class="k">for</span> <span class="n">package_name</span><span class="p">,</span><span class="n">modules</span> <span class="ow">in</span> <span class="n">pkg_to_module</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">--- working on package: </span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
        <span class="c1"># 2) Run all of the module name replacements</span>

        <span class="n">word_comb</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">word_pattern</span>
        <span class="n">modules_or</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="c1"># easy_import_pattern = (</span>
        <span class="c1"># f&quot;(?:(import {modules_or} as {word_comb}))&quot;</span>
        <span class="c1"># f&quot;|(?:from {word_comb} (import {modules_or} as {word_comb}))&quot;</span>
        <span class="c1"># f&quot;|(?:(import {modules_or}))&quot;</span>
        <span class="c1"># f&quot;|(?:from {word_comb} (import {modules_or}))&quot;  </span>
        <span class="c1"># )</span>

        <span class="c1"># this pattern will not match the proceeding and then in </span>
        <span class="c1"># group 1 will match the </span>
        <span class="n">easy_import_pattern</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(?:from </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2"> )?&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(import </span><span class="si">{</span><span class="n">modules_or</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="n">word_comb</span><span class="si">}</span><span class="s2">|import </span><span class="si">{</span><span class="n">modules_or</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">easy_replacement</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2"> \1&quot;</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- easy initial replacement --&quot;</span><span class="p">)</span>
        <span class="n">filu</span><span class="o">.</span><span class="n">file_regex_replace</span><span class="p">(</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">easy_import_pattern</span><span class="p">,</span>
            <span class="n">replacement</span> <span class="o">=</span> <span class="n">easy_replacement</span><span class="p">,</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">,</span>
            <span class="n">overwrite_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- harder initial replacement --&quot;</span><span class="p">)</span>

        <span class="n">harder_import_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?:from [.]*(</span><span class="si">{</span><span class="n">modules_or</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">ru</span><span class="o">.</span><span class="n">word_pattern_comma_space</span><span class="si">}</span><span class="s2">))&quot;</span>
        <span class="n">harder_replacement</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">.\1&quot;</span>
        <span class="n">filu</span><span class="o">.</span><span class="n">file_regex_replace</span><span class="p">(</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">harder_import_pattern</span><span class="p">,</span>
            <span class="n">replacement</span> <span class="o">=</span> <span class="n">harder_replacement</span><span class="p">,</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">,</span>
            <span class="n">overwrite_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">package_name</span> <span class="o">==</span> <span class="n">curr_package_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- easier relative replacement --&quot;</span><span class="p">)</span>

            <span class="n">easy_import_relative</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span><span class="si">}</span><span class="s2">)from </span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="n">easy_replacement_relative</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;\1from . &quot;</span>

            <span class="n">filu</span><span class="o">.</span><span class="n">file_regex_replace</span><span class="p">(</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">easy_import_relative</span><span class="p">,</span>
                <span class="n">replacement</span> <span class="o">=</span> <span class="n">easy_replacement_relative</span><span class="p">,</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">,</span>
                <span class="n">overwrite_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- harder relative replacement --&quot;</span><span class="p">)</span>

            <span class="n">harder_import_relative</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span><span class="si">}</span><span class="s2">)from </span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="n">harder_replacement_relative</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;\1from .&quot;</span>

            <span class="n">filu</span><span class="o">.</span><span class="n">file_regex_replace</span><span class="p">(</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">harder_import_relative</span><span class="p">,</span>
                <span class="n">replacement</span> <span class="o">=</span> <span class="n">harder_replacement_relative</span><span class="p">,</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">,</span>
                <span class="n">overwrite_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
            <span class="p">)</span>
            
    <span class="c1">#2) getting all the docstrings</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">filu</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
    <span class="n">multi_line_comm</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">multiline_str</span><span class="p">(</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">return_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">above_first_func_def</span> <span class="o">=</span> <span class="n">docstring_only_above_first_func_def</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">range_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">span</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">multi_line_comm</span><span class="p">]</span>

    <span class="n">data_doc</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">remove_range_list</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">range_list</span><span class="o">=</span><span class="n">range_list</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">all_doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">modu</span><span class="o">.</span><span class="n">multiline_str_text</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">multi_line_comm</span><span class="p">]</span>
    
    
    
    <span class="c1">#3) Getting all of the packages </span>
    <span class="n">finds</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">find_import_modules_in_file</span><span class="p">(</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data_doc</span><span class="p">,</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">beginning_of_line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">finds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">finds</span><span class="p">))</span>

    <span class="n">finds_len</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">finds</span><span class="p">]</span>
    <span class="n">finds_for_query</span> <span class="o">=</span> <span class="p">[</span><span class="n">finds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">finds_len</span><span class="p">))]</span>
    <span class="n">module_pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ru</span><span class="o">.</span><span class="n">start_of_line_pattern</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">finds_for_query</span><span class="p">)</span><span class="si">}</span><span class="s2">)(?![0-9a-zA-z _\.\-:]+)&quot;</span>
    <span class="c1">#print(f&quot;module_pattern = {module_pattern}&quot;)</span>
    <span class="n">data_doc_no_mod</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">subn</span><span class="p">(</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">module_pattern</span><span class="p">,</span>
        <span class="n">repl</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="n">data_doc</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of modules replaced = </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">#data_doc_no_mod = data_doc</span>

    <span class="n">pkg_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pkg_to_module</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">non_pkg_mods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pkg_mods</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">own_mod</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">finds</span><span class="p">:</span>
        <span class="n">set_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">curr_mod</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">own_mod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s2">&quot;from .&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">curr_package_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pkg_mods</span><span class="p">:</span>
                <span class="n">pkg_mods</span><span class="p">[</span><span class="n">curr_package_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">pkg_mods</span><span class="p">[</span><span class="n">curr_package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">pkg_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pkg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pkg_mods</span><span class="p">:</span>
                    <span class="n">pkg_mods</span><span class="p">[</span><span class="n">pkg</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">pkg_mods</span><span class="p">[</span><span class="n">pkg</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">set_flag</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">set_flag</span><span class="p">:</span>
            <span class="n">non_pkg_mods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>


    <span class="n">non_pkg_mods_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">non_pkg_mods</span><span class="p">)</span>
    <span class="n">own_mod_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">own_mod</span><span class="p">)</span>
    <span class="n">pkg_mods_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;#--- from </span><span class="si">{</span><span class="n">pkg</span><span class="si">}</span><span class="s2"> ---</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">pkg</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="n">pkg_mods</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">])</span>
    
    <span class="c1">#get rid of any old package documentation (in case run documentation again)</span>
    <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">pkg_mods</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">data_doc_no_mod</span> <span class="o">=</span> <span class="n">data_doc_no_mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#--- from </span><span class="si">{</span><span class="n">pkg</span><span class="si">}</span><span class="s2"> ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;----non_pkg_mods_str = &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">non_pkg_mods_str</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;----pkg_mods_str = &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">pkg_mods_str</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;----own_mod_str = &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">own_mod_str</span><span class="p">)</span>
        
        
    <span class="c1"># 4) Creating the final module string</span>


    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_doc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">all_doc_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_doc</span><span class="p">)</span>
        <span class="n">all_doc_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&#39;&#39;&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">all_doc_str</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#39;&#39;&#39;</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_doc_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_pkg_mods_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">non_pkg_mods_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_separator</span><span class="si">}{</span><span class="n">non_pkg_mods_str</span><span class="si">}{</span><span class="n">separator</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pkg_mods_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pkg_mods_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_separator</span><span class="si">}{</span><span class="n">pkg_mods_str</span><span class="si">}{</span><span class="n">separator</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">own_mod_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">own_mod_str</span><span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_separator</span><span class="si">}{</span><span class="n">own_mod_str</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">final_data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">all_doc_str</span> <span class="o">+</span>
        <span class="n">non_pkg_mods_str</span> <span class="o">+</span> 
        <span class="n">data_doc_no_mod</span> <span class="o">+</span>
        <span class="n">pkg_mods_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
        <span class="n">own_mod_str</span>
    <span class="p">)</span>
    
    
    <span class="c1"># 5) Outputting final string</span>
    <span class="n">filu</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span>
        <span class="n">output_path</span><span class="p">,</span>
        <span class="n">final_data</span><span class="p">,</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span></div>

    
<div class="viewcode-block" id="package_from_import_string"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.package_from_import_string">[docs]</a><span class="k">def</span> <span class="nf">package_from_import_string</span><span class="p">(</span>
    <span class="n">string</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: find the package </span>
<span class="sd">    from the import statement using</span>
<span class="sd">    regex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;\s*(?:from|import) ([a-zA-Z_]+|.)&quot;</span>

    <span class="n">package</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="n">string</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">package</span></div>
    
    

<div class="viewcode-block" id="package_imports_from_files"><a class="viewcode-back" href="../../python_tools.html#python_tools.module_utils.package_imports_from_files">[docs]</a><span class="k">def</span> <span class="nf">package_imports_from_files</span><span class="p">(</span>
    <span class="n">files</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Find all of the modules imported</span>
<span class="sd">    from all the files in a directory and </span>
<span class="sd">    compile a unique list</span>

<span class="sd">    Pseudocode: </span>
<span class="sd">    1) Get all of the modules in the directory</span>
<span class="sd">    2) For each module, get a list of the imports</span>
<span class="sd">    3) restrict the name of the imports to only beginning important part</span>
<span class="sd">    4) make a unique list from all of the lists</span>
<span class="sd">    </span>
<span class="sd">    Ex: </span>
<span class="sd">    modu.package_imports_from_files(</span>
<span class="sd">        directory = &quot;/graph_tools/graph_tools/&quot;,</span>
<span class="sd">    )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">files</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">pku</span><span class="o">.</span><span class="n">module_files_from_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="n">all_imports</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- working on </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> --&quot;</span><span class="p">)</span>
        <span class="n">import_statements</span> <span class="o">=</span> <span class="n">modu</span><span class="o">.</span><span class="n">find_import_modules_in_file</span><span class="p">(</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filepath</span><span class="p">,</span>
            <span class="n">beginning_of_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">import_statements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">all_imports</span> <span class="o">+=</span> <span class="n">import_statements</span>

    <span class="c1">#3) restrict the name of the imports to only beginning important part</span>
    <span class="n">all_imports</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">modu</span><span class="o">.</span><span class="n">package_from_import_string</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_imports</span>
    <span class="p">]</span>

    <span class="n">all_imports</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_imports</span><span class="p">))))</span>
    <span class="n">all_imports</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_imports</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">all_imports</span></div>
    

    
    
    
<span class="c1">#from python_tools import file_utils as filu</span>


            

    





<span class="c1">#--- from python_tools ---</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">data_struct_utils</span> <span class="k">as</span> <span class="n">dsu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">file_utils</span> <span class="k">as</span> <span class="n">filu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">general_utils</span> <span class="k">as</span> <span class="n">gu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">numpy_utils</span> <span class="k">as</span> <span class="n">nu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">package_utils</span> <span class="k">as</span> <span class="n">pku</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pathlib_utils</span> <span class="k">as</span> <span class="n">plu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">regex_utils</span> <span class="k">as</span> <span class="n">ru</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">string_utils</span> <span class="k">as</span> <span class="n">stru</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">system_utils</span> <span class="k">as</span> <span class="n">su</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">module_utils</span> <span class="k">as</span> <span class="n">modu</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Brendan Celii.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>