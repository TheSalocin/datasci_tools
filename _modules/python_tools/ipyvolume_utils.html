<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>python_tools.ipyvolume_utils &mdash; python_tools 1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            python_tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">python_tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">python_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">python_tools.ipyvolume_utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for python_tools.ipyvolume_utils</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>



<span class="sd">Purpose: To summarize and expose ipyvolume functionality</span>

<span class="sd">Tutorial: https://www.youtube.com/watch?v=hOKa8klJPyo</span>
<span class="sd">Documentation: https://ipyvolume.readthedocs.io/_/downloads/en/docs/pdf/</span>

<span class="sd">Notes: </span>
<span class="sd">- whenever changing properties on ipyvolume you do so through the returned object and the transition is interpolated</span>
<span class="sd">- ARRAYS HAVE TO BE FLOATS TO SHOW UP</span>

<span class="sd">The upper left controls: </span>
<span class="sd">1) Eye: allows 2 outputs from different angles for VR</span>
<span class="sd">2) The icon can select 3D so can output data for 3D viewing in google cardboard</span>
<span class="sd">(180 or 360 degrees)</span>



<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">ipyvolume.moviemaker</span> <span class="kn">import</span> <span class="n">MovieMaker</span>
<span class="kn">import</span> <span class="nn">ipyvolume</span> <span class="k">as</span> <span class="nn">ipv</span>
<span class="kn">import</span> <span class="nn">ipywebrtc</span> <span class="k">as</span> <span class="nn">webrtc</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">numpy_dep</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">trimesh</span>



<span class="c1">#import ipyvolume as ipv</span>
<span class="c1">#import ipywidgets as widgets</span>
<span class="c1">#from IPython.display import display</span>
<span class="c1">#from . import numpy_dep as np</span>

<div class="viewcode-block" id="print_selection_hotkeys"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.print_selection_hotkeys">[docs]</a><span class="k">def</span> <span class="nf">print_selection_hotkeys</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Now hold the CTRL key to do selections, type</span>

<span class="s2">    ‘C’ for circle</span>
<span class="s2">    ‘R’ for rectangle</span>
<span class="s2">    ‘L’ for lasso</span>
<span class="s2">    ‘=’ for replace mode</span>
<span class="s2">    ‘&amp;’ for logically and mode</span>
<span class="s2">    ‘|’ for logically or mode</span>
<span class="s2">    ‘-’ for subtract mode</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="example_scatter_plot"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_scatter_plot">[docs]</a><span class="k">def</span> <span class="nf">example_scatter_plot</span><span class="p">():</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
<div class="viewcode-block" id="example_widgets_linked_to_attributes"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_widgets_linked_to_attributes">[docs]</a><span class="k">def</span> <span class="nf">example_widgets_linked_to_attributes</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pseudocode: </span>
<span class="sd">    1) Create dummy data</span>
<span class="sd">    2) Create scatter plot and store result</span>
<span class="sd">    3) Link the results attributes to different widgets</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sphere&quot;</span><span class="p">,</span><span class="s2">&quot;box&quot;</span><span class="p">,</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="s2">&quot;circle_2d&quot;</span><span class="p">,</span><span class="s2">&quot;point_2d&quot;</span><span class="p">,</span><span class="s2">&quot;arow&quot;</span><span class="p">],</span>
                             <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Scatter Marker&quot;</span><span class="p">)</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">scatter</span><span class="p">,</span><span class="s2">&quot;geo&quot;</span><span class="p">),(</span><span class="n">w</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
    
    <span class="n">slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Scatter Size&quot;</span><span class="p">)</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">scatter</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">),(</span><span class="n">slider</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
    
    <span class="n">display</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">slider</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="example_quiver_plot_and_attributes"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_quiver_plot_and_attributes">[docs]</a><span class="k">def</span> <span class="nf">example_quiver_plot_and_attributes</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">))</span> <span class="o">+</span> <span class="n">offset</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">quiver</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>

    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># --- Adds a button for flipping ---</span>
    <span class="n">flip_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Flip Arrows&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">flip_arrows_func</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">quiver</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">quiver</span><span class="o">.</span><span class="n">vx</span>
        <span class="n">quiver</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">quiver</span><span class="o">.</span><span class="n">vy</span>
        <span class="n">quiver</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="o">-</span><span class="n">quiver</span><span class="o">.</span><span class="n">vz</span>

    <span class="n">flip_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">flip_arrows_func</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">flip_button</span><span class="p">)</span>
    
    <span class="n">cp</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ColorPicker</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Pick Color&quot;</span><span class="p">)</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">jsdlink</span><span class="p">((</span><span class="n">cp</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">),(</span><span class="n">quiver</span><span class="p">,</span><span class="s2">&quot;color&quot;</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="set_xyzlim"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_xyzlim">[docs]</a><span class="k">def</span> <span class="nf">set_xyzlim</span><span class="p">(</span><span class="n">axes_min</span><span class="p">,</span><span class="n">axes_max</span><span class="p">):</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">xyzlim</span><span class="p">(</span><span class="n">axes_min</span><span class="p">,</span><span class="n">axes_max</span><span class="p">)</span></div>
    
<span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">tetrahedron_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">]])</span>
<span class="n">tetrahedron_triangles</span> <span class="o">=</span> <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    
<div class="viewcode-block" id="example_mesh"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_mesh">[docs]</a><span class="k">def</span> <span class="nf">example_mesh</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">tetrahedron_vertices</span><span class="o">.</span><span class="n">T</span>

    <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">new_mesh</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">triangles</span> <span class="o">=</span> <span class="n">tetrahedron_triangles</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;sphere&quot;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">xyzlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">new_mesh</span></div>
    
<span class="c1">#from python_tools import numpy_utils as nu</span>
<div class="viewcode-block" id="example_plot_line_segments"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_plot_line_segments">[docs]</a><span class="k">def</span> <span class="nf">example_plot_line_segments</span><span class="p">(</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">array</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]]])</span>
        
    <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">vertices</span><span class="p">,</span><span class="n">lines</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">coordinates_edges_from_line_segments</span><span class="p">(</span>
        <span class="n">array</span>
    <span class="p">)</span>

    <span class="n">mesh2</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
                                <span class="n">vertices</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
                                <span class="n">vertices</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> 
                                <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">mesh2</span></div>

<span class="n">example_plot_skeleton</span> <span class="o">=</span> <span class="n">example_plot_line_segments</span>
    
<div class="viewcode-block" id="example_surface_not_mesh"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_surface_not_mesh">[docs]</a><span class="k">def</span> <span class="nf">example_surface_not_mesh</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">alter_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;alter_surface&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">alter_func</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">mesh</span><span class="o">.</span><span class="n">y</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.4</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>

    <span class="n">alter_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">alter_func</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">alter_button</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="example_plot_line"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_plot_line">[docs]</a><span class="k">def</span> <span class="nf">example_plot_line</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4000</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span><span class="n">r</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span><span class="n">r</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">u</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">change_line</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;change line&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_line_func</span><span class="p">(</span><span class="n">info</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span><span class="n">r</span>
        <span class="n">line</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span><span class="n">r</span>
        <span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">u</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="o">*</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">change_line</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">change_line_func</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">change_line</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="animation_off"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.animation_off">[docs]</a><span class="k">def</span> <span class="nf">animation_off</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="mi">0</span></div>
<span class="w">    </span>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">For selection:</span>
<span class="sd">Can add the kwargs: color_selected to control color of the selected</span>


<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="example_scatter"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_scatter">[docs]</a><span class="k">def</span> <span class="nf">example_scatter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span></div>
<div class="viewcode-block" id="example_selection"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_selection">[docs]</a><span class="k">def</span> <span class="nf">example_selection</span><span class="p">():</span>
    <span class="n">ipvu</span><span class="o">.</span><span class="n">print_selection_hotkeys</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">example_scatter</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">selector_default</span><span class="p">()</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nd">@out</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">clear_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">print_info</span><span class="p">(</span><span class="o">*</span><span class="n">_</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">scatter</span><span class="o">.</span><span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">meanx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scatter</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean of x = </span><span class="si">{</span><span class="n">meanx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="n">scatter</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">print_info</span><span class="p">,</span><span class="s2">&quot;selected&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="scatter_selected_idx"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.scatter_selected_idx">[docs]</a><span class="k">def</span> <span class="nf">scatter_selected_idx</span><span class="p">(</span><span class="n">scatter</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">scatter</span><span class="o">.</span><span class="n">selected</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">scatter</span><span class="o">.</span><span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="set_style"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_style">[docs]</a><span class="k">def</span> <span class="nf">set_style</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prospective styles: light, dark</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="set_dark_background"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_dark_background">[docs]</a><span class="k">def</span> <span class="nf">set_dark_background</span><span class="p">():</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="set_white_background"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_white_background">[docs]</a><span class="k">def</span> <span class="nf">set_white_background</span><span class="p">():</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;light&quot;</span><span class="p">)</span></div>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Animations: if feed into a variable like x or y</span>
<span class="sd">a 2D array, knows that the first component is time</span>
<span class="sd">and then can animate by using the sequence_index</span>

<span class="sd">ex: x.shape = (200,313) # 200 time points, 313 data</span>

<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="set_selector_default"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_selector_default">[docs]</a><span class="k">def</span> <span class="nf">set_selector_default</span><span class="p">():</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">selector_default</span><span class="p">()</span></div>

<div class="viewcode-block" id="add_animation_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_animation_widget">[docs]</a><span class="k">def</span> <span class="nf">add_animation_widget</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">interval</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    interval: interval in msec between each frame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">animation_control</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="example_time_quiver_dataset"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_time_quiver_dataset">[docs]</a><span class="k">def</span> <span class="nf">example_time_quiver_dataset</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">animated_stream</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,::</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span> </div>

<div class="viewcode-block" id="change_time_interval"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.change_time_interval">[docs]</a><span class="k">def</span> <span class="nf">change_time_interval</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">sequence_index</span> <span class="o">=</span> <span class="n">time_idx</span></div>
    
<div class="viewcode-block" id="example_animation_through_time"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_animation_through_time">[docs]</a><span class="k">def</span> <span class="nf">example_animation_through_time</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Psueodocode: </span>
<span class="sd">    1) Create a time dataset</span>
<span class="sd">    2) Create a quiver using the 2D dataset</span>
<span class="sd">    3) Add animation control</span>
<span class="sd">    4) Add widget to control the properties</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span>  <span class="o">=</span> <span class="n">example_time_quiver_dataset</span><span class="p">()</span>
    
    <span class="c1"># 2) Creating the quiver</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
    <span class="n">quiver</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1">#3) Adding the Animation Control</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">animation_control</span><span class="p">(</span><span class="n">quiver</span><span class="p">,</span><span class="n">interval</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
    
    
    <span class="c1">#4) Adding the control on widget properties</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;arrow&#39;</span><span class="p">,</span><span class="s1">&#39;sphere&#39;</span><span class="p">,</span><span class="s1">&#39;cat&#39;</span><span class="p">],</span>
    <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">)</span>

    <span class="n">widgets</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">quiver</span><span class="p">,</span><span class="s2">&quot;geo&quot;</span><span class="p">),(</span><span class="n">w</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>
<span class="w">    </span>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Making movies: </span>
<span class="sd">1) Add: adds keyframes</span>
<span class="sd">2) Set the interpolation to smooth</span>
<span class="sd">3) Press play</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#from ipyvolume.moviemaker import MovieMaker</span>
<div class="viewcode-block" id="example_movie"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_movie">[docs]</a><span class="k">def</span> <span class="nf">example_movie</span><span class="p">():</span>
    <span class="n">ipvu</span><span class="o">.</span><span class="n">example_animation_through_time</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    
    <span class="n">mm</span> <span class="o">=</span> <span class="n">MovieMaker</span><span class="p">(</span><span class="n">stream</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span><span class="n">camera</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">camera</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">widget_main</span><span class="p">)</span></div>
    
<span class="c1">#import ipywebrtc as webrtc</span>
<div class="viewcode-block" id="example_movie_recorded"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.example_movie_recorded">[docs]</a><span class="k">def</span> <span class="nf">example_movie_recorded</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;bc_example&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hit the begin record button, then stop the record button</span>
<span class="sd">    and then it will play back the saved video</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ipvu</span><span class="o">.</span><span class="n">example_movie</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span><span class="n">webrtc</span><span class="o">.</span><span class="n">VideoRecorder</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">))</span></div>
    
<span class="c1"># ------------- utils to help with plotting ---- </span>
<span class="c1">#import ipywidgets as widgets</span>
<div class="viewcode-block" id="add_attribute_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_attribute_widget">[docs]</a><span class="k">def</span> <span class="nf">add_attribute_widget</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="n">widget</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">description_prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">display_widget</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="c1">#print(f&quot;description_prefix = {description_prefix}&quot;)</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">description_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description_prefix</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
    
    <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">default_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">try</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">widgets</span><span class="p">,</span><span class="n">widget</span><span class="p">)(</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">widgets</span><span class="p">,</span><span class="n">widget</span><span class="p">)(</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">widget</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ColorPicker&quot;</span><span class="p">]:</span>
        <span class="n">link_func</span> <span class="o">=</span> <span class="s2">&quot;jslink&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">link_func</span> <span class="o">=</span> <span class="s2">&quot;link&quot;</span>
    <span class="n">curr_link</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">widgets</span><span class="p">,</span><span class="n">link_func</span><span class="p">)((</span><span class="n">obj</span><span class="p">,</span><span class="n">attribute</span><span class="p">),(</span><span class="n">w</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">display_widget</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span></div>

<div class="viewcode-block" id="add_size_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_size_widget">[docs]</a><span class="k">def</span> <span class="nf">add_size_widget</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="k">return</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">add_attribute_widget</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="s2">&quot;FloatSlider&quot;</span><span class="p">,</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span>
        <span class="nb">max</span><span class="o">=</span><span class="nb">max</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_color_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_color_widget">[docs]</a><span class="k">def</span> <span class="nf">add_color_widget</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">return</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">add_attribute_widget</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="s2">&quot;ColorPicker&quot;</span><span class="p">,</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_alpha_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_alpha_widget">[docs]</a><span class="k">def</span> <span class="nf">add_alpha_widget</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">return</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">add_attribute_widget</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="s2">&quot;FloatSlider&quot;</span><span class="p">,</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="s2">&quot;alpha&quot;</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="n">marker_options</span><span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;arrow&quot;</span><span class="p">,</span><span class="s2">&quot;box&quot;</span><span class="p">,</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="s2">&quot;sphere&quot;</span><span class="p">,</span><span class="s2">&quot;point_2d&quot;</span><span class="p">,</span><span class="s2">&quot;square_2d&quot;</span><span class="p">,</span><span class="s2">&quot;triangle_2d&quot;</span><span class="p">,</span><span class="s2">&quot;circle_2d&quot;</span><span class="p">,</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span>
<span class="p">)</span>

<div class="viewcode-block" id="add_marker_widget"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.add_marker_widget">[docs]</a><span class="k">def</span> <span class="nf">add_marker_widget</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="n">marker_options</span><span class="p">,</span>
    <span class="n">default_value</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">return</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">add_attribute_widget</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="s2">&quot;Dropdown&quot;</span><span class="p">,</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="s2">&quot;geo&quot;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="n">default_value</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="set_axes_lim"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_axes_lim">[docs]</a><span class="k">def</span> <span class="nf">set_axes_lim</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lim</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">xlim</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">zlim</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start func&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xlim = </span><span class="si">{</span><span class="n">xlim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ylim = </span><span class="si">{</span><span class="n">ylim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;zlim = </span><span class="si">{</span><span class="n">zlim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        

    <span class="k">if</span> <span class="nb">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">max</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nb">max</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">zlim</span><span class="p">(</span><span class="nb">min</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nb">max</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span>
        
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">lim</span>
        
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">lim</span>
        
    <span class="k">if</span> <span class="n">zlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">lim</span>
        
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inside func&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xlim = </span><span class="si">{</span><span class="n">xlim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ylim = </span><span class="si">{</span><span class="n">ylim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;zlim = </span><span class="si">{</span><span class="n">zlim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">zlim</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">set_view</span><span class="p">(</span><span class="n">distance</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="get_axes_lim"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_axes_lim">[docs]</a><span class="k">def</span> <span class="nf">get_axes_lim</span><span class="p">(</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">old_lims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">fig</span><span class="o">.</span><span class="n">xlim</span><span class="p">,</span><span class="n">fig</span><span class="o">.</span><span class="n">ylim</span><span class="p">,</span><span class="n">fig</span><span class="o">.</span><span class="n">zlim</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">old_lims</span></div>

<div class="viewcode-block" id="set_axes_lim_to_cube"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_axes_lim_to_cube">[docs]</a><span class="k">def</span> <span class="nf">set_axes_lim_to_cube</span><span class="p">(</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To set the limits of the xyz</span>
<span class="sd">    to be a square equal to the longest current size</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">get_axes_lim</span><span class="p">()</span> 
    <span class="n">new_bbox</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">bbox_cube_from_bbox</span><span class="p">(</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_lim</span><span class="p">(</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="n">new_bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="n">new_bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span>
    <span class="p">)</span></div>
    
<div class="viewcode-block" id="set_axes_visibility"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_axes_visibility">[docs]</a><span class="k">def</span> <span class="nf">set_axes_visibility</span><span class="p">(</span><span class="n">visibility</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visibility</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">axes_off</span><span class="p">()</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">box_off</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">axes_on</span><span class="p">()</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">box_on</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="save_to_html"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.save_to_html">[docs]</a><span class="k">def</span> <span class="nf">save_to_html</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="get_xyz_lim"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_xyz_lim">[docs]</a><span class="k">def</span> <span class="nf">get_xyz_lim</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">fig</span><span class="o">.</span><span class="n">xlim</span><span class="p">,</span><span class="n">fig</span><span class="o">.</span><span class="n">ylim</span><span class="p">,</span><span class="n">fig</span><span class="o">.</span><span class="n">zlim</span><span class="p">])</span><span class="o">.</span><span class="n">T</span></div>

<div class="viewcode-block" id="get_xyz_radius"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_xyz_radius">[docs]</a><span class="k">def</span> <span class="nf">get_xyz_radius</span><span class="p">():</span>
    <span class="n">curr_ax</span> <span class="o">=</span> <span class="n">get_xyz_lim</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">curr_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">curr_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span></div>

<div class="viewcode-block" id="get_center_coordinate"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_center_coordinate">[docs]</a><span class="k">def</span> <span class="nf">get_center_coordinate</span><span class="p">(</span><span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">get_xyz_lim</span><span class="p">(),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">coord</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">coord</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">coord</span></div>

<span class="n">get_camera_center</span> <span class="o">=</span> <span class="n">get_center_coordinate</span>

<div class="viewcode-block" id="set_zoom"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_zoom">[docs]</a><span class="k">def</span> <span class="nf">set_zoom</span><span class="p">(</span>
    <span class="n">center_coordinate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">radius_xyz</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_at_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">axis_visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    
    <span class="k">if</span> <span class="n">center_coordinate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">center_coordinate</span> <span class="o">=</span> <span class="n">get_center_coordinate</span><span class="p">(</span><span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">)</span>
        
    <span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">center_coordinate</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">coord</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">coord</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">radius_xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">radius_xyz</span> <span class="o">=</span> <span class="n">get_xyz_radius</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">radius_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">radius</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">radius</span><span class="p">])</span>
            
        
        
    <span class="n">coord_radius</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">radius</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">radius_xyz</span><span class="p">]</span>
    <span class="n">ipv_function</span> <span class="o">=</span> <span class="p">[</span><span class="n">ipv</span><span class="o">.</span><span class="n">xlim</span><span class="p">,</span><span class="n">ipv</span><span class="o">.</span><span class="n">ylim</span><span class="p">,</span><span class="n">ipv</span><span class="o">.</span><span class="n">zlim</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">c_rad</span><span class="p">,</span><span class="n">ipvf</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">coord_radius</span><span class="p">,</span><span class="n">ipv_function</span><span class="p">):</span>
        <span class="n">ipvf</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">c_rad</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c_rad</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis_visibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_visibility</span><span class="p">(</span><span class="n">axis_visibility</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_at_end</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  </div>
        
<div class="viewcode-block" id="clear_figure"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.clear_figure">[docs]</a><span class="k">def</span> <span class="nf">clear_figure</span><span class="p">():</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="get_all_fig_scatters"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_all_fig_scatters">[docs]</a><span class="k">def</span> <span class="nf">get_all_fig_scatters</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">return_list</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">scatters</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of scatter objects = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="get_all_fig_meshes"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_all_fig_meshes">[docs]</a><span class="k">def</span> <span class="nf">get_all_fig_meshes</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">return_list</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">meshes</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;# of meshes objects = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="get_all_fig_objs"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.get_all_fig_objs">[docs]</a><span class="k">def</span> <span class="nf">get_all_fig_objs</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To get all the objects</span>
<span class="sd">    of the current figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">return_list</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">get_all_fig_scatters</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span> 
        <span class="o">+</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">get_all_fig_meshes</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span> 
    <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="coords_from_obj"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.coords_from_obj">[docs]</a><span class="k">def</span> <span class="nf">coords_from_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Find the coordinates of an obj</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;z&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="coords_min_max_from_obj"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.coords_min_max_from_obj">[docs]</a><span class="k">def</span> <span class="nf">coords_min_max_from_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">coords_from_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="coords_min_max_from_fig"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.coords_min_max_from_fig">[docs]</a><span class="k">def</span> <span class="nf">coords_min_max_from_fig</span><span class="p">(</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: to find the min and max coordinates</span>
<span class="sd">    of all the objects in a current figure</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">all_objs</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">get_all_fig_objs</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="n">min_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">max_coords</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_objs</span><span class="p">:</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">coords_min_max_from_obj</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">min_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">max_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">all_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">min_coords</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">all_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">max_coords</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">return_coords</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">all_min</span><span class="p">,</span><span class="n">all_max</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min,Max = </span><span class="si">{</span><span class="n">return_coords</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_coords</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="set_axes_lim_from_fig"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_axes_lim_from_fig">[docs]</a><span class="k">def</span> <span class="nf">set_axes_lim_from_fig</span><span class="p">(</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To automatically set the zoom to include</span>
<span class="sd">    all the coordinates of the current scatters</span>
<span class="sd">    and meshes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    
    <span class="n">buffer_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">buffer</span><span class="p">,</span><span class="o">-</span><span class="n">buffer</span><span class="p">,</span><span class="o">-</span><span class="n">buffer</span><span class="p">,],</span>
                             <span class="p">[</span><span class="n">buffer</span><span class="p">,</span><span class="n">buffer</span><span class="p">,</span><span class="n">buffer</span><span class="p">,]</span>
                            <span class="p">])</span>
    <span class="n">min_max_coords</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">coords_min_max_from_fig</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span> <span class="o">+</span> <span class="n">buffer_array</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_max_coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_lim</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="n">min_max_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">max</span><span class="o">=</span><span class="n">min_max_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="scatter_plot_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.scatter_plot_func">[docs]</a><span class="k">def</span> <span class="nf">scatter_plot_func</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="k">return</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">array</span><span class="p">),</span>
                       <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                       <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span></div>
    
<div class="viewcode-block" id="surface_plot_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.surface_plot_func">[docs]</a><span class="k">def</span> <span class="nf">surface_plot_func</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="k">return</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="o">*</span><span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">array</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="line_plot_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.line_plot_func">[docs]</a><span class="k">def</span> <span class="nf">line_plot_func</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="k">return</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">array</span><span class="p">))</span></div>

<div class="viewcode-block" id="line_segments_plot_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.line_segments_plot_func">[docs]</a><span class="k">def</span> <span class="nf">line_segments_plot_func</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vertices</span><span class="p">,</span><span class="n">lines</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">coordinates_edges_from_line_segments</span><span class="p">(</span>
            <span class="n">array</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">array</span>
    
    <span class="k">return</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
                                <span class="n">vertices</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
                                <span class="n">vertices</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> 
                                <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span></div>

<span class="n">skeleton_plot_func</span> <span class="o">=</span> <span class="n">line_segments_plot_func</span>
    
<div class="viewcode-block" id="trisurf_plot_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.trisurf_plot_func">[docs]</a><span class="k">def</span> <span class="nf">trisurf_plot_func</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">triangles</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">,</span>
                           <span class="p">)</span></div>

<span class="n">mesh_plot_func</span> <span class="o">=</span> <span class="n">trisurf_plot_func</span>

<span class="c1">#from python_tools import matplotlib_utils as mu</span>
    
<div class="viewcode-block" id="plot_obj"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_obj">[docs]</a><span class="k">def</span> <span class="nf">plot_obj</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span>
    <span class="c1">#all possible inputs to functions</span>
    <span class="n">triangles</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;marker&quot;</span><span class="p">,</span><span class="s2">&quot;color&quot;</span><span class="p">),</span>
    <span class="n">widget_description_prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">axis_visibility</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">individually_scale_each_axis</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To plot an object</span>
<span class="sd">    using a plot type (and possibly add on widgets)</span>
<span class="sd">    to help control</span>
<span class="sd">    </span>
<span class="sd">    from python_tools import ipyvolume_utils as ipvu</span>
<span class="sd">    import ipyvolume as ipv</span>

<span class="sd">    ipvu.plot_obj(</span>
<span class="sd">        array = cell_centers,</span>
<span class="sd">        flip_y = True</span>
<span class="sd">    )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">new_figure</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        
        
    <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;line_segments&quot;</span>
    <span class="k">elif</span> <span class="n">triangles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;mesh&quot;</span>
        
        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ipvu</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2">_plot_func&quot;</span><span class="p">)(</span>
            <span class="n">array</span><span class="p">,</span>
            <span class="n">triangles</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">,</span>
            <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1">#print(f&quot;changing colors&quot;)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mu</span><span class="o">.</span><span class="n">color_to_rgb</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">color</span><span class="p">])</span>
        <span class="n">scat</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#print(f&quot;Setting size&quot;)</span>
            <span class="n">scat</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>

        
    
        <span class="n">widget_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">widgets_to_plot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#         wid = ipvu.add_size_widget(scat,prefix=&quot;test_size&quot;)</span>
<span class="c1">#         widget_list.append(wid)</span>
<span class="c1">#         display(widgets.HBox(widget_list))</span>
<span class="c1">#         ipv.show()</span>
<span class="c1">#         return </span>
        <span class="n">idx_for_description</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">plot_widgets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">widgets_to_plot</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">idx_for_description</span><span class="p">:</span>
                        <span class="n">description_prefix</span> <span class="o">=</span> <span class="n">widget_description_prefix</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">description_prefix</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">curr_widget</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                        <span class="n">ipvu</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;add_</span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">_widget&quot;</span>
                    <span class="p">)(</span><span class="n">scat</span><span class="p">,</span><span class="n">description_prefix</span><span class="o">=</span><span class="n">description_prefix</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="c1">#print(f&quot;Adding widget = {w}&quot;)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">idx_for_description</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1">#print(e)</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">widget_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_widget</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">widget_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">(</span><span class="n">widget_list</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="mi">0</span>
    
    
    <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_lim_from_fig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scat</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">scat</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">color_to_rgba</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">scat</span><span class="o">.</span><span class="n">color</span><span class="p">),</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_at_end</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_visibility</span><span class="p">(</span><span class="n">axis_visibility</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">individually_scale_each_axis</span><span class="p">:</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_lim_to_cube</span><span class="p">()</span>
        
    <span class="k">return</span> <span class="n">scat</span></div>
    
<span class="c1">#def add_marker_selection()</span>
<div class="viewcode-block" id="xyz_from_array"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.xyz_from_array">[docs]</a><span class="k">def</span> <span class="nf">xyz_from_array</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">array</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span></div>

<span class="c1">#from python_tools import matplotlib_utils as mu</span>
<span class="c1">#from python_tools import mesh_utils as mhu</span>
<div class="viewcode-block" id="plot_mesh"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_mesh">[docs]</a><span class="k">def</span> <span class="nf">plot_mesh</span><span class="p">(</span>
    <span class="n">mesh</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,),</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">mesh</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">mhu</span><span class="o">.</span><span class="n">combine_meshes</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="n">return_mesh</span> <span class="o">=</span>  <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_obj</span><span class="p">(</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span>
        <span class="c1">#all possible inputs to functions</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span>
        <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="n">widgets_to_plot</span><span class="p">,</span>
        <span class="n">show_at_end</span> <span class="o">=</span> <span class="n">show_at_end</span><span class="p">,</span>
        <span class="n">new_figure</span> <span class="o">=</span> <span class="n">new_figure</span><span class="p">,</span>
        <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    
<span class="c1">#     if alpha is not None:</span>
<span class="c1">#         return_mesh.material.transparent = True</span>
<span class="c1">#         return_mesh.color = mu.color_to_rgba(str(return_mesh.color),alpha)</span>
<span class="c1">#         print(f&quot;return_mesh.color = {return_mesh.color}&quot;)</span>
<span class="c1">#         ipv.show()</span>
    <span class="k">return</span> <span class="n">return_mesh</span></div>


<div class="viewcode-block" id="plot_mesh_with_scatter"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_mesh_with_scatter">[docs]</a><span class="k">def</span> <span class="nf">plot_mesh_with_scatter</span><span class="p">(</span>
    <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mesh_alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
    
    
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mesh_obj</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_mesh</span><span class="p">(</span>
                <span class="n">mesh</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">mesh_alpha</span><span class="p">,</span>
                <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
                <span class="n">show_at_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_mesh</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="n">sc_obj</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span>
            <span class="n">scatter</span><span class="p">,</span>
            <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">new_figure</span> <span class="o">=</span> <span class="n">new_figure</span><span class="p">,</span>
            <span class="n">show_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span> 
    
    <span class="k">return</span> <span class="n">mesh_obj</span><span class="p">,</span><span class="n">sc_obj</span></div>
    
<div class="viewcode-block" id="plot_scatter"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_scatter">[docs]</a><span class="k">def</span> <span class="nf">plot_scatter</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;marker&quot;</span><span class="p">,</span><span class="s2">&quot;color&quot;</span><span class="p">),</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">axis_visibility</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_scatter</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">widget_description_prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        
    <span class="n">array</span><span class="o">=</span>  <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">return_sc</span> <span class="o">=</span>  <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_obj</span><span class="p">(</span>
        <span class="n">array</span><span class="p">,</span>
        <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span>
        <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="n">widgets_to_plot</span><span class="p">,</span>
        <span class="n">show_at_end</span> <span class="o">=</span> <span class="n">show_at_end</span><span class="p">,</span>
        <span class="n">new_figure</span> <span class="o">=</span> <span class="n">new_figure</span><span class="p">,</span>
        <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="n">axis_visibility</span><span class="o">=</span><span class="n">axis_visibility</span><span class="p">,</span>
        <span class="n">widget_description_prefix</span><span class="o">=</span><span class="n">widget_description_prefix</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">return_scatter</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">return_sc</span></div>
    


<span class="c1">#from python_tools import numpy_utils as nu</span>

<div class="viewcode-block" id="plot_multi_scatters"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_multi_scatters">[docs]</a><span class="k">def</span> <span class="nf">plot_multi_scatters</span><span class="p">(</span>
    <span class="n">scatters</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;marker&quot;</span><span class="p">,</span><span class="s2">&quot;color&quot;</span><span class="p">),</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">axis_visibility</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To plot a group of synapses and have the </span>
<span class="sd">    scatter controls to be able to control size for each color</span>


<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">scatters</span> <span class="o">=</span> <span class="p">[</span><span class="n">scatters</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="n">size</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span>
        
    <span class="n">sum_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">scatters</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">sum_points</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No scatters to plot&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_at_end</span><span class="p">:</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">all_scatter_obj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,(</span><span class="n">sc</span><span class="p">,</span><span class="n">sc_c</span><span class="p">,</span><span class="n">sz</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
        <span class="n">scatters</span><span class="p">,</span>
        <span class="n">color</span><span class="p">,</span>
        <span class="n">size</span><span class="p">,</span>
        <span class="p">)):</span>
        
        <span class="n">show_at_end_inner</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">new_figure_inner</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">show_at_end</span><span class="p">:</span>
            <span class="n">show_at_end_inner</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">new_figure</span><span class="p">:</span>
            <span class="n">new_figure_inner</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sc_obj</span> <span class="o">=</span> <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span>
            <span class="n">sc</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">sz</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">sc_c</span><span class="p">,</span>
            <span class="n">show_at_end</span> <span class="o">=</span> <span class="n">show_at_end_inner</span><span class="p">,</span>
            <span class="n">new_figure</span> <span class="o">=</span> <span class="n">new_figure_inner</span><span class="p">,</span>
            <span class="n">axis_visibility</span><span class="o">=</span><span class="n">axis_visibility</span><span class="p">,</span>
            <span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">,</span>
            <span class="n">widgets_to_plot</span><span class="o">=</span><span class="n">widgets_to_plot</span><span class="p">,</span>
            <span class="n">return_scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        
        <span class="n">all_scatter_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sc_obj</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">all_scatter_obj</span></div>


<div class="viewcode-block" id="print_ipv_cheatsheet"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.print_ipv_cheatsheet">[docs]</a><span class="k">def</span> <span class="nf">print_ipv_cheatsheet</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Ipyvolume Cheat sheet: </span>

<span class="s2">    1) Alt + Click and Hold: Can drag object</span>
<span class="s2">    2) Pinch: zoom in and Out</span>
<span class="s2">    3) Magnifying glass on + pinch: Zoom in and Out on place mouse hovering</span>
<span class="s2">    4) Double click and move mouse: rotate object</span>
<span class="s2">    5) gear icon: different resolutions</span>
<span class="s2">    6) Shift + Picture: Copies screenshot to clipboard</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="clear_selected"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.clear_selected">[docs]</a><span class="k">def</span> <span class="nf">clear_selected</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="kc">None</span></div>
    
<div class="viewcode-block" id="view_top_down"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.view_top_down">[docs]</a><span class="k">def</span> <span class="nf">view_top_down</span><span class="p">(</span>
    <span class="n">axis_visibility</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: Make a top down view</span>
<span class="sd">    of the current figure</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    azimuth (float) – rotation around the axis pointing up in degrees</span>
<span class="sd">    elevation (float) – rotation where +90 means ‘up’, -90 means ‘down’, in degrees</span>
<span class="sd">    distance (float) – radial distance from the center to the camera.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_visibility</span><span class="p">(</span><span class="n">axis_visibility</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">elevation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="set_view"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_view">[docs]</a><span class="k">def</span> <span class="nf">set_view</span><span class="p">(</span>
    <span class="n">h_rotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">v_rotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">#between -90 (down) and 90 (up)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">#multiplier distance from axes</span>
    <span class="n">center</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">axis_visibility</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: To set the</span>
<span class="sd">    zoom level, and then </span>
<span class="sd">    the proper rotation of an ipyvolume</span>
<span class="sd">    figure (to recreate )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">ipvu</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span>
        <span class="n">center_coordinate</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">ipv</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">view</span><span class="p">(</span>
        <span class="n">azimuth</span><span class="o">=</span><span class="n">h_rotation</span><span class="p">,</span>
        <span class="n">elevation</span><span class="o">=</span><span class="n">v_rotation</span><span class="p">,</span>
        <span class="n">distance</span><span class="o">=</span><span class="n">distance</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">axis_visibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">set_axes_visibility</span><span class="p">(</span><span class="n">axis_visibility</span><span class="p">)</span></div>
    
    
<span class="n">show_top_down</span> <span class="o">=</span> <span class="n">view_top_down</span>
<span class="n">top_down</span> <span class="o">=</span> <span class="n">view_top_down</span>
    
<div class="viewcode-block" id="plot_skeleton"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_skeleton">[docs]</a><span class="k">def</span> <span class="nf">plot_skeleton</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span><span class="n">edges</span><span class="p">,</span><span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_obj</span><span class="p">(</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">,</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span>
        <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span></div>

    
<div class="viewcode-block" id="flip_y_func"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.flip_y_func">[docs]</a><span class="k">def</span> <span class="nf">flip_y_func</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">array</span></div>
<div class="viewcode-block" id="plot_quiver"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_quiver">[docs]</a><span class="k">def</span> <span class="nf">plot_quiver</span><span class="p">(</span>
    <span class="n">centers</span><span class="p">,</span>
    <span class="n">vectors</span><span class="p">,</span>
    <span class="n">color_array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_colormap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">size_array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: plotting quiver with a </span>
<span class="sd">    color gradient determined by an </span>
<span class="sd">    attribute (and a size gradient optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="n">flip_y_func</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="n">flip_y_func</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">new_figure</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">quiver</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
        <span class="o">*</span><span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">centers</span><span class="p">,),</span>
        <span class="o">*</span><span class="n">ipvu</span><span class="o">.</span><span class="n">xyz_from_array</span><span class="p">(</span><span class="n">vectors</span><span class="p">,)</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">color_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quiver</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">gradient_from_array</span><span class="p">(</span>
            <span class="n">color_array</span><span class="p">,</span>
            <span class="n">plot_colormap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">size_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quiver</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size_array</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;size&quot;</span><span class="p">)</span>
        <span class="n">widgets</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">quiver</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">),(</span><span class="n">slider</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
        <span class="n">slider</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">display</span><span class="p">(</span><span class="n">slider</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_at_end</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="plot_line_segments"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_line_segments">[docs]</a><span class="k">def</span> <span class="nf">plot_line_segments</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;marker&quot;</span><span class="p">,</span><span class="s2">&quot;color&quot;</span><span class="p">),</span>
    <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">axis_visibility</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_obj</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">widget_description_prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    
    <span class="n">return_sc</span> <span class="o">=</span>  <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_obj</span><span class="p">(</span>
        <span class="n">array</span><span class="p">,</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;line_segments&quot;</span><span class="p">,</span>
        <span class="n">plot_widgets</span> <span class="o">=</span> <span class="n">plot_widgets</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span>
        <span class="n">widgets_to_plot</span> <span class="o">=</span> <span class="n">widgets_to_plot</span><span class="p">,</span>
        <span class="n">show_at_end</span> <span class="o">=</span> <span class="n">show_at_end</span><span class="p">,</span>
        <span class="n">new_figure</span> <span class="o">=</span> <span class="n">new_figure</span><span class="p">,</span>
        <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="n">axis_visibility</span><span class="o">=</span><span class="n">axis_visibility</span><span class="p">,</span>
        <span class="n">widget_description_prefix</span><span class="o">=</span><span class="n">widget_description_prefix</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">return_obj</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">return_sc</span></div>
    
<span class="n">plot_quiver_with_gradients</span> <span class="o">=</span> <span class="n">plot_quiver</span>

<span class="c1"># --------------- helper functions with making movies ----</span>
<div class="viewcode-block" id="rotation_movie_export"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.rotation_movie_export">[docs]</a><span class="k">def</span> <span class="nf">rotation_movie_export</span><span class="p">():</span>
    <span class="c1"># create 2d grids: x, y, and r</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x,y and z are of shape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="c1"># and turn them into 1d</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;and flattened of shape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


    <span class="c1"># create a sequence of 15 time elements</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;z is of shape&quot;</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># draw the scatter plot, and add controls with animate_glyphs</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;sphere&quot;</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">animation_control</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Now also include, color, which containts rgb values</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mf">0.1</span><span class="o">+</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">time</span><span class="p">)])</span>
    <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;color is of shape&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


    <span class="c1">#This is commented out, otherwise it would run on readthedocs</span>
    <span class="k">def</span> <span class="nf">set_view</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">framenr</span><span class="p">,</span> <span class="n">fraction</span><span class="p">):</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">fraction</span><span class="o">*</span><span class="mi">360</span><span class="p">)</span>
        <span class="c1">#s.size = size * (2+0.5*np.sin(fraction * 6 * np.pi))</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">movie</span><span class="p">(</span><span class="s1">&#39;wave.mp4&#39;</span><span class="p">,</span> <span class="n">set_view</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span></div>
    
<span class="c1">#import ipywidgets</span>
 
<span class="c1">#import os</span>
<div class="viewcode-block" id="movie"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.movie">[docs]</a><span class="k">def</span> <span class="nf">movie</span><span class="p">(</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;movie.mp4&quot;</span><span class="p">,</span> 
    <span class="c1">#function=_change_azimuth_angle, </span>
    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
    <span class="n">frames</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">cmd_template_ffmpeg</span><span class="o">=</span><span class="s2">&quot;ffmpeg -y -r </span><span class="si">{fps}</span><span class="s2"> -i </span><span class="si">{tempdir}</span><span class="s2">/frame-</span><span class="si">%5d</span><span class="s2">.png -vcodec h264 -pix_fmt yuv420p </span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">cmd_template_gif</span><span class="o">=</span><span class="s2">&quot;convert -delay </span><span class="si">{delay}</span><span class="s2"> </span><span class="si">{loop}</span><span class="s2"> </span><span class="si">{tempdir}</span><span class="s2">/frame-*.png </span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">gif_loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">1920</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">1080</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a movie (mp4/gif) out of many frames</span>

<span class="sd">    If the filename ends in `.gif`, `convert` is used to convert all frames to an animated gif using the `cmd_template_gif`</span>
<span class="sd">    template. Otherwise `ffmpeg is assumed to know the file format`.</span>

<span class="sd">    Example:</span>

<span class="sd">    &gt;&gt;&gt; def set_angles(fig, i, fraction):</span>
<span class="sd">    &gt;&gt;&gt;     fig.angley = fraction*np.pi*2</span>
<span class="sd">    &gt;&gt;&gt; # 4 second movie, that rotates around the y axis</span>
<span class="sd">    &gt;&gt;&gt; p3.movie(&#39;test2.gif&#39;, set_angles, fps=20, frames=20*4,</span>
<span class="sd">            endpoint=False)</span>

<span class="sd">    Note that in the example above we use `endpoint=False` to avoid to first and last frame to be the same</span>

<span class="sd">    :param str f: filename out output movie (e.g. &#39;movie.mp4&#39; or &#39;movie.gif&#39;)</span>
<span class="sd">    :param function: function called before each frame with arguments (figure, framenr, fraction)</span>
<span class="sd">    :param fps: frames per seconds</span>
<span class="sd">    :param int frames: total number of frames</span>
<span class="sd">    :param bool endpoint: if fraction goes from [0, 1] (inclusive) or [0, 1) (endpoint=False is useful for loops/rotatations)</span>
<span class="sd">    :param str cmd_template_ffmpeg: template command when running ffmpeg (non-gif ending filenames)</span>
<span class="sd">    :param str cmd_template_gif: template command when running imagemagick&#39;s convert (if filename ends in .gif)</span>
<span class="sd">    :param gif_loop: None for no loop, otherwise the framenumber to go to after the last frame</span>
<span class="sd">    :return: the temp dir where the frames are stored</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">movie_filename</span> <span class="o">=</span> <span class="n">filename</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>
    <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">ipywidgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">fraction</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">frames</span> <span class="o">-</span> <span class="mf">1.</span> <span class="k">if</span> <span class="n">endpoint</span> <span class="k">else</span> <span class="n">frames</span><span class="p">)</span>
            <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">fraction</span><span class="p">)</span>
            <span class="n">frame_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s2">&quot;frame-</span><span class="si">%05d</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">frame_filename</span><span class="p">,</span> <span class="n">output_widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">movie_filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">gif_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">loop</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loop</span> <span class="o">=</span> <span class="s2">&quot;-loop </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">gif_loop</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">fps</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmd_template_gif</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span> <span class="n">tempdir</span><span class="o">=</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">movie_filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmd_template_ffmpeg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">tempdir</span><span class="o">=</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">movie_filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tempdir</span></div>

<div class="viewcode-block" id="save_fig"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.save_fig">[docs]</a><span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">default_dim</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">width</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">default_dim</span><span class="o">*</span><span class="n">scale</span>
    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">default_dim</span><span class="o">*</span><span class="n">scale</span>
    <span class="n">save_config_ex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">_ipv_pic.png&quot;</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.png&quot;</span>
    <span class="n">ipv</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="o">**</span><span class="n">save_config_ex</span><span class="p">,</span>
    <span class="p">)</span></div>
    
<div class="viewcode-block" id="set_axes_lim_equal_width_from_array"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.set_axes_lim_equal_width_from_array">[docs]</a><span class="k">def</span> <span class="nf">set_axes_lim_equal_width_from_array</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">flip_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
    
    <span class="n">axes_lim</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">axes_lim_equal_width</span><span class="p">(</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="p">,</span>
        <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">buffer</span><span class="o">=</span><span class="n">buffer</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="n">set_axes_lim</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="n">axes_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="n">axes_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">zlim</span><span class="o">=</span><span class="n">axes_lim</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="p">)</span></div>
<span class="w">    </span>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example of how to use ipvu.movie to make a movie about a neuron: </span>

<span class="sd">exc_name = &quot;864691135494192528_0&quot;</span>
<span class="sd">conu.visualize_graph_connections_by_method(</span>
<span class="sd">    G,</span>
<span class="sd">    segment_ids = [bpc_name,bc_name,exc_name],</span>
<span class="sd">    segment_ids_colors = [&quot;skyblue&quot;,&quot;orange&quot;,&quot;black&quot;],</span>
<span class="sd">    method = &quot;meshafterparty&quot;,</span>
<span class="sd">    plot_gnn=False,</span>
<span class="sd">    synapse_color = &quot;red&quot;,</span>
<span class="sd">    plot_soma_centers=False,</span>
<span class="sd">    </span>
<span class="sd">    plot_synapse_skeletal_paths = True,</span>
<span class="sd">    plot_proofread_skeleton = False,</span>
<span class="sd">    </span>
<span class="sd">    synapse_path_presyn_color=&#39;plum&#39;,</span>
<span class="sd">    synapse_path_postsyn_color=&#39;lime&#39;,</span>
<span class="sd">    </span>
<span class="sd">    transparency = 0.8,</span>
<span class="sd">    </span>
<span class="sd">    synapse_scatter_size=1.4,</span>
<span class="sd">    synapse_path_scatter_size=0.7,</span>
<span class="sd">    </span>
<span class="sd">)</span>


<span class="sd"># apt install ffmpeg</span>
<span class="sd">def set_view(figure, framenr, fraction):</span>
<span class="sd">    ipv.view(fraction*360,distance = 1)</span>
<span class="sd">    #s.size = size * (2+0.5*np.sin(fraction * 6 * np.pi))</span>
<span class="sd">    </span>
<span class="sd">fps = 60</span>
<span class="sd">n_sec = 10</span>
<span class="sd">ipvu.movie(</span>
<span class="sd">    filename = f&#39;./bpc_mc_23p_rotation.mp4&#39;, </span>
<span class="sd">    func=set_view,</span>
<span class="sd">    fps=fps, </span>
<span class="sd">    frames=fps*n_sec,</span>
<span class="sd">    cmd_template_ffmpeg=&#39;ffmpeg -y -r {fps} -i {tempdir}/frame-%5d.png -vcodec h264 -pix_fmt yuv420p {filename}&#39;,</span>
<span class="sd">)</span>

<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="lighting_parameters"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.lighting_parameters">[docs]</a><span class="k">def</span> <span class="nf">lighting_parameters</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ambient_coefficient – lighting parameter</span>
<span class="s2">    diffuse_coefficient – lighting parameter</span>
<span class="s2">    specular_coefficient – lighting parameter</span>
<span class="s2">    specular_exponent – lighting parameter</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span></div>

<span class="c1"># ------ plotting functions ported over</span>

<div class="viewcode-block" id="plot_ipv_mesh"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_ipv_mesh">[docs]</a><span class="k">def</span> <span class="nf">plot_ipv_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
                 <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="c1">#print(&quot;inside elephant flipping copy&quot;)</span>
        <span class="n">elephant_mesh_sub</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">elephant_mesh_sub</span> <span class="o">=</span> <span class="n">mesh</span>
    
    
    <span class="c1">#check if the color is a dictionary</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="c1">#get the type of values stored in there</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        
        <span class="c1">#if the labels were stored as just numbers/decimals</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="c1">#get all of the possible labels</span>
            <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="c1">#get random colors for all of the labels</span>
            <span class="n">colors_list</span> <span class="o">=</span>  <span class="n">mu</span><span class="o">.</span><span class="n">generate_color_list</span><span class="p">(</span><span class="n">n_colors</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lab</span><span class="p">,</span><span class="n">curr_color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">,</span><span class="n">colors_list</span><span class="p">):</span>
                <span class="c1">#find the faces that correspond to that label</span>
                <span class="n">faces_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">color</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">lab</span><span class="p">]</span>
                <span class="c1">#draw the mesh with that color</span>
                <span class="n">curr_mesh</span> <span class="o">=</span> <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">submesh</span><span class="p">([</span><span class="n">faces_to_keep</span><span class="p">],</span><span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
                <span class="n">mesh4</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                               <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
                               <span class="n">triangles</span><span class="o">=</span><span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
                <span class="n">mesh4</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">curr_color</span>
                <span class="n">mesh4</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>          
        <span class="n">mesh4</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
                                   <span class="n">triangles</span><span class="o">=</span><span class="n">elephant_mesh_sub</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
        <span class="n">mesh4</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="n">mesh4</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span></div>
        

<div class="viewcode-block" id="convert_skeleton_to_nodes_edges_optimized"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.convert_skeleton_to_nodes_edges_optimized">[docs]</a><span class="k">def</span> <span class="nf">convert_skeleton_to_nodes_edges_optimized</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Purpose: will return the nodes and edges but without making the nodes unique</span>
<span class="sd">    (so will have some repeats)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unique_rows</span>  <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">curr_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_rows</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unique_rows</span><span class="p">,</span> <span class="n">curr_edges</span></div>

<div class="viewcode-block" id="plot_ipv_skeleton"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_ipv_skeleton">[docs]</a><span class="k">def</span> <span class="nf">plot_ipv_skeleton</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#print(&quot;Edge coordinates in plot_ipv_skeleton were of 0 length so returning&quot;)</span>
        <span class="k">return</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">edge_coordinates</span> <span class="o">=</span> <span class="n">edge_coordinates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">edge_coordinates</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">edge_coordinates</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> 
    
    <span class="c1">#print(f&quot;edge_coordinates inside after change = {edge_coordinates}&quot;)</span>
    <span class="n">unique_skeleton_verts_final</span><span class="p">,</span><span class="n">edges_final</span> <span class="o">=</span> <span class="n">convert_skeleton_to_nodes_edges_optimized</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">)</span>
    <span class="n">mesh2</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
                            <span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
                            <span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> 
                            <span class="n">lines</span><span class="o">=</span><span class="n">edges_final</span><span class="p">)</span>
    <span class="c1">#print(f&quot;color in ipv_skeleton = {color}&quot;)</span>
    <span class="n">mesh2</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span> 
    <span class="n">mesh2</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1">#print(f&quot;Color in skeleton ipv plot = {color}&quot;)</span>

    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">unique_skeleton_verts_final</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">unique_skeleton_verts_final</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">unique_skeleton_verts_final</span></div>

<div class="viewcode-block" id="plot_ipv_scatter"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_ipv_scatter">[docs]</a><span class="k">def</span> <span class="nf">plot_ipv_scatter</span><span class="p">(</span><span class="n">scatter_points</span><span class="p">,</span><span class="n">scatter_color</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span>
                    <span class="n">scatter_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                    <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scatter_points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> 
    
    <span class="n">scatter_points</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scatter_points</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">scatter_points</span> <span class="o">=</span> <span class="n">scatter_points</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">scatter_points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">scatter_points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#     print(f&quot;scatter_points[:,0] = {scatter_points[:,0]}&quot;)</span>
<span class="c1">#     print(f&quot;scatter_points[:,1] = {scatter_points[:,1]}&quot;)</span>
<span class="c1">#     print(f&quot;scatter_points[:,2] = {scatter_points[:,2]}&quot;)</span>
<span class="c1">#     print(f&quot;scatter_size = {scatter_size}&quot;)</span>
<span class="c1">#     print(f&quot;scatter_color = {scatter_color}&quot;)</span>
    <span class="n">mesh_5</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">scatter_points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">scatter_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">scatter_points</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> 
            <span class="n">size</span><span class="o">=</span><span class="n">scatter_size</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="n">scatter_color</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;sphere&quot;</span><span class="p">)</span>
    <span class="n">mesh_5</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span></div>



<div class="viewcode-block" id="graph_skeleton_and_mesh"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.graph_skeleton_and_mesh">[docs]</a><span class="k">def</span> <span class="nf">graph_skeleton_and_mesh</span><span class="p">(</span><span class="n">main_mesh_verts</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">main_mesh_faces</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">unique_skeleton_verts_final</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">edges_final</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">edge_coordinates</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">other_meshes</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">other_meshes_colors</span> <span class="o">=</span>  <span class="p">[],</span>
                            <span class="n">mesh_alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                            <span class="n">other_meshes_face_components</span> <span class="o">=</span> <span class="p">[],</span>
                            <span class="n">other_skeletons</span> <span class="o">=</span> <span class="p">[],</span>
                            <span class="n">other_skeletons_colors</span> <span class="o">=</span>  <span class="p">[],</span>
                            <span class="n">return_other_colors</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">main_mesh_color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
                            <span class="n">main_skeleton_color</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">main_mesh_face_coloring</span> <span class="o">=</span> <span class="p">[],</span>
                            <span class="n">other_scatter</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">scatter_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
                            <span class="n">other_scatter_colors</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">main_scatter_color</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span>
                            <span class="n">scatter_with_widgets</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">buffer</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                           <span class="n">axis_box_off</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">html_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                           <span class="n">show_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">append_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">set_zoom</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">adaptive_min_max_limits</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Graph the final result of skeleton and mesh</span>
<span class="sd">    </span>
<span class="sd">    Pseudocode on how to do face colorings :</span>
<span class="sd">    could get a dictionary mapping faces to colors or groups</span>
<span class="sd">    - if mapped to groups then do random colors (and generate them)</span>
<span class="sd">    - if mapped to colors then just do submeshes and send the colors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#print(f&quot;other_scatter = {other_scatter}&quot;)</span>
    <span class="c1">#print(f&quot;mesh_alpha = {mesh_alpha}&quot;)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">append_figure</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
    
    <span class="n">main_mesh_vertices</span> <span class="o">=</span> <span class="p">[]</span>
    
    
    <span class="c1">#print(&quot;Working on main skeleton&quot;)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_skeleton_verts_final</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_final</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
            <span class="n">edge_coordinates</span> <span class="o">=</span> <span class="n">edge_coordinates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">edge_coordinates</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">edge_coordinates</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">unique_skeleton_verts_final</span><span class="p">,</span><span class="n">edges_final</span> <span class="o">=</span> <span class="n">convert_skeleton_to_nodes_edges_optimized</span><span class="p">(</span><span class="n">edge_coordinates</span><span class="p">)</span>
        <span class="n">mesh2</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
                                <span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
                                <span class="n">unique_skeleton_verts_final</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> 
                                <span class="n">lines</span><span class="o">=</span><span class="n">edges_final</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

        <span class="n">mesh2</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">main_skeleton_color</span> 
        <span class="n">mesh2</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
            <span class="n">unique_skeleton_verts_final</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">unique_skeleton_verts_final</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unique_skeleton_verts_final</span><span class="p">)</span>
    
    <span class="c1">#print(&quot;Working on main mesh&quot;)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_verts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_faces</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_face_coloring</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#will go through and color the faces of the main mesh if any sent</span>
            <span class="k">for</span> <span class="n">face_array</span><span class="p">,</span><span class="n">face_color</span> <span class="ow">in</span> <span class="n">main_mesh_face_coloring</span><span class="p">:</span>
                <span class="n">curr_mesh</span> <span class="o">=</span> <span class="n">main_mesh</span><span class="o">.</span><span class="n">submesh</span><span class="p">([</span><span class="n">face_array</span><span class="p">],</span><span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">plot_ipv_mesh</span><span class="p">(</span><span class="n">curr_mesh</span><span class="p">,</span><span class="n">face_color</span><span class="p">,</span><span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
                <span class="n">main_mesh_verts</span> <span class="o">=</span> <span class="n">main_mesh_verts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">main_mesh_verts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">main_mesh_verts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="n">main_mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">main_mesh_verts</span><span class="p">,</span><span class="n">faces</span><span class="o">=</span><span class="n">main_mesh_faces</span><span class="p">)</span>

            <span class="n">mesh3</span> <span class="o">=</span> <span class="n">ipv</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">main_mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">main_mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">main_mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
                                   <span class="n">triangles</span><span class="o">=</span><span class="n">main_mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
            
            <span class="n">mesh3</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">main_mesh_color</span>
            <span class="n">mesh3</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="kc">True</span>
            
            <span class="c1">#flipping them back</span>
            <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
                <span class="n">main_mesh_verts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">main_mesh_verts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_mesh_verts</span><span class="p">)</span>
        
    
    <span class="c1"># cast everything to list type</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">other_meshes</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_meshes</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_meshes_colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_meshes_colors</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">other_meshes_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_meshes_colors</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">other_skeletons</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_skeletons</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_skeletons_colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_skeletons_colors</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">other_skeletons_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_skeletons_colors</span><span class="p">]</span>
        
<span class="c1">#     if type(other_scatter) != list and type(other_scatter) != np.ndarray:</span>
<span class="c1">#         other_scatter = [other_scatter]</span>
<span class="c1">#     if type(other_scatter_colors) != list and type(other_scatter_colors) != np.ndarray:</span>
<span class="c1">#         other_scatter_colors = [other_scatter_colors]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">):</span>
        <span class="n">other_scatter</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_scatter</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">other_scatter_colors</span><span class="p">):</span>
        <span class="n">other_scatter_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_scatter_colors</span><span class="p">]</span>
    
        
    
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_meshes_face_components</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">other_meshes_colors</span> <span class="o">=</span> <span class="n">other_meshes_face_components</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_meshes_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">other_meshes_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_mesh_color</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#get the locations of all of the dictionaries</span>
            <span class="k">if</span> <span class="s2">&quot;random&quot;</span> <span class="ow">in</span> <span class="n">other_meshes_colors</span><span class="p">:</span>
                <span class="n">other_meshes_colors</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">generate_color_list</span><span class="p">(</span>
                            <span class="n">user_colors</span><span class="o">=</span><span class="p">[],</span> <span class="c1">#if user sends a prescribed list</span>
                            <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">),</span>
                            <span class="c1">#colors_to_omit=[&quot;green&quot;,&quot;blue&quot;], #because that is the one used for the main mesh</span>
                            <span class="n">alpha_level</span><span class="o">=</span><span class="n">mesh_alpha</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_meshes_colors</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">generate_color_list</span><span class="p">(</span>
                            <span class="n">user_colors</span><span class="o">=</span><span class="n">other_meshes_colors</span><span class="p">,</span> <span class="c1">#if user sends a prescribed list</span>
                            <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">),</span>
                            <span class="c1">#colors_to_omit=[&quot;green&quot;,&quot;blue&quot;], #because that is the one used for the main mesh</span>
                            <span class="n">alpha_level</span><span class="o">=</span><span class="n">mesh_alpha</span><span class="p">)</span>
            
    
       
    <span class="c1">#print(&quot;Working on other meshes&quot;)</span>
    <span class="k">for</span> <span class="n">curr_mesh</span><span class="p">,</span><span class="n">curr_color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other_meshes</span><span class="p">,</span><span class="n">other_meshes_colors</span><span class="p">):</span>
        <span class="c1">#print(f&quot;flip_y = {flip_y}&quot;)</span>
        <span class="n">plot_ipv_mesh</span><span class="p">(</span><span class="n">curr_mesh</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">curr_color</span><span class="p">,</span><span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">curr_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
    
    
    <span class="c1">#print(&quot;Working on other skeletons&quot;)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_skeletons_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">other_skeletons_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_skeleton_color</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;random&quot;</span> <span class="ow">in</span> <span class="n">other_skeletons_colors</span><span class="p">:</span>
            <span class="n">other_skeletons_colors</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">generate_color_list</span><span class="p">(</span>
                        <span class="n">user_colors</span><span class="o">=</span><span class="p">[],</span> <span class="c1">#if user sends a prescribed list</span>
                        <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">),</span>
                        <span class="c1">#colors_to_omit=[&quot;green&quot;,&quot;blue&quot;], #because that is the one used for the main mesh</span>
                        <span class="n">alpha_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            
            <span class="n">other_skeletons_colors</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">generate_color_list</span><span class="p">(</span>
                        <span class="n">user_colors</span><span class="o">=</span><span class="n">other_skeletons_colors</span><span class="p">,</span> <span class="c1">#if user sends a prescribed list</span>
                        <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">),</span>
                        <span class="c1">#colors_to_omit=[&quot;green&quot;,&quot;blue&quot;], #because that is the one used for the main mesh</span>
                        <span class="n">alpha_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#print(f&quot;user colors picked for other_skeletons_colors = {other_skeletons_colors}&quot;)</span>
    
        
    <span class="k">for</span> <span class="n">curr_sk</span><span class="p">,</span><span class="n">curr_color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other_skeletons</span><span class="p">,</span><span class="n">other_skeletons_colors</span><span class="p">):</span>
        <span class="n">sk_vertices</span> <span class="o">=</span> <span class="n">plot_ipv_skeleton</span><span class="p">(</span><span class="n">curr_sk</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">curr_color</span><span class="p">,</span><span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">)</span>
        
        <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sk_vertices</span><span class="p">)</span>
        
        
    <span class="c1">#printing the scatter plots</span>
    <span class="c1">#print(&quot;Working on other scatter plots&quot;)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_scatter_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">other_scatter_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_scatter_color</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">)</span>
        
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_scatter_colors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">):</span>
        <span class="n">other_scatter_colors</span> <span class="o">+=</span> <span class="n">other_scatter_colors</span>
        
        
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">scatter_size</span><span class="p">):</span>
        <span class="n">scatter_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">scatter_size</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">)</span>
        
    
    <span class="k">for</span> <span class="n">curr_scatter</span><span class="p">,</span><span class="n">curr_color</span><span class="p">,</span><span class="n">curr_size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other_scatter</span><span class="p">,</span><span class="n">other_scatter_colors</span><span class="p">,</span><span class="n">scatter_size</span><span class="p">):</span>
<span class="c1">#         print(f&quot;curr_scatter = {curr_scatter}&quot;)</span>
<span class="c1">#         print(f&quot;curr_color = {curr_color}&quot;)</span>
<span class="c1">#         print(f&quot;curr_size= {curr_size}&quot;)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scatter_with_widgets</span><span class="p">:</span>
            <span class="n">plot_ipv_scatter</span><span class="p">(</span><span class="n">curr_scatter</span><span class="p">,</span><span class="n">scatter_color</span><span class="o">=</span><span class="n">curr_color</span><span class="p">,</span>
                        <span class="n">scatter_size</span><span class="o">=</span><span class="n">curr_size</span><span class="p">,</span><span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">)</span>
        <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_scatter</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="n">scatter_with_widgets</span><span class="p">:</span>
        <span class="n">ipvu</span><span class="o">.</span><span class="n">plot_multi_scatters</span><span class="p">(</span>
            <span class="n">other_scatter</span><span class="p">,</span><span class="n">other_scatter_colors</span><span class="p">,</span><span class="n">scatter_size</span><span class="p">,</span>
            <span class="n">show_at_end</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">new_figure</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">flip_y</span> <span class="o">=</span> <span class="n">flip_y</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="c1">#create the main mesh vertices for setting the bounding box</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_vertices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No meshes or skeletons passed to the plotting funciton&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_vertices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">main_mesh_vertices</span> <span class="o">=</span> <span class="n">main_mesh_vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#get rid of all empt</span>
        <span class="c1">#print(f&quot;main_mesh_vertices = {main_mesh_vertices}&quot;)</span>
        <span class="n">main_mesh_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">k</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">main_mesh_vertices</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_vertices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***There is nothing to plot***&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    

<span class="c1">#     print(f&quot;main_mesh_vertices = {main_mesh_vertices}&quot;)</span>
    
    <span class="k">if</span> <span class="n">flip_y</span><span class="p">:</span>
        <span class="n">main_mesh_vertices</span> <span class="o">=</span> <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">main_mesh_vertices</span> <span class="o">=</span> <span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">main_mesh_vertices</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">main_mesh_vertices</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    

    <span class="n">volume_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">volume_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">main_mesh_vertices</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
<span class="c1">#     if len(main_mesh_vertices) &lt; 10:</span>
<span class="c1">#         print(f&quot;main_mesh_vertices = {main_mesh_vertices}&quot;)</span>
<span class="c1">#     print(f&quot;volume_max= {volume_max}&quot;)</span>
<span class="c1">#     print(f&quot;volume_min= {volume_min}&quot;)</span>

    <span class="n">ranges</span> <span class="o">=</span> <span class="n">volume_max</span> <span class="o">-</span> <span class="n">volume_min</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span>
    <span class="n">min_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">max_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>


    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">max_index</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">adaptive_min_max_limits</span><span class="p">:</span>
            <span class="n">min_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">buffer</span>
            <span class="n">max_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">buffer</span> 
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">difference</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="n">max_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ranges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">min_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">difference</span><span class="o">/</span><span class="mi">2</span>  <span class="o">-</span> <span class="n">buffer</span>
            <span class="n">max_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">difference</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">buffer</span>
            
<span class="c1">#     print(f&quot;min_limits= {min_limits}&quot;)</span>
<span class="c1">#     print(f&quot;max_limits= {max_limits}&quot;)</span>

    <span class="c1">#ipv.xyzlim(-2, 2)</span>
    
    <span class="k">if</span> <span class="n">set_zoom</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">min_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">max_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">min_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">max_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">zlim</span><span class="p">(</span><span class="n">min_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">max_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


        <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style_light</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">axis_box_off</span><span class="p">:</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">axes_off</span><span class="p">()</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">box_off</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">axes_on</span><span class="p">()</span>
            <span class="n">ipv</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">box_on</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">show_at_end</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">html_path</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">ipv</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">html_path</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">return_other_colors</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">other_meshes_colors</span></div>
        








<div class="viewcode-block" id="plot_objects"><a class="viewcode-back" href="../../python_tools.html#python_tools.ipyvolume_utils.plot_objects">[docs]</a><span class="k">def</span> <span class="nf">plot_objects</span><span class="p">(</span><span class="n">main_mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">main_skeleton</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">main_mesh_color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
                 <span class="n">main_mesh_alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 
                <span class="n">main_skeleton_color</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">meshes</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">meshes_colors</span> <span class="o">=</span>  <span class="p">[],</span>
                <span class="n">mesh_alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                            
                <span class="n">skeletons</span> <span class="o">=</span> <span class="p">[],</span>
                <span class="n">skeletons_colors</span> <span class="o">=</span>  <span class="p">[],</span>
                            
                <span class="n">scatters</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">scatters_colors</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">scatter_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
                <span class="n">main_scatter_color</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span>
                <span class="n">scatter_with_widgets</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 
                <span class="n">buffer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="c1">#1000,</span>
                <span class="n">axis_box_off</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">html_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">show_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">append_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                
                <span class="n">subtract_from_main_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">set_zoom</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1">#used for the skeleton graph</span>
                <span class="n">zoom_coordinate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">zoom_radius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">zoom_radius_xyz</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">adaptive_min_max_limits</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="c1">#from neurd import neuron_visualizations as nviz</span>
    <span class="c1">#nviz = reload(nviz)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">main_mesh</span> <span class="ow">is</span> <span class="kc">None</span> 
        <span class="ow">and</span> <span class="n">main_skeleton</span> <span class="ow">is</span> <span class="kc">None</span> 
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">meshes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">skeletons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nothing to plot so returning&quot;</span><span class="p">)</span>
        <span class="k">return</span> 
    
    
        
    <span class="k">if</span> <span class="n">main_skeleton</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">edge_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edge_coordinates</span><span class="o">=</span><span class="n">main_skeleton</span>
        
        
    <span class="n">convert_to_list_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">meshes</span><span class="p">,</span><span class="n">meshes_colors</span><span class="p">,</span><span class="n">skeletons</span><span class="p">,</span>
                            <span class="n">skeletons_colors</span><span class="p">,</span><span class="n">scatters</span><span class="p">,</span><span class="n">scatters_colors</span><span class="p">,</span><span class="n">scatter_size</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">convert_to_list</span><span class="p">(</span><span class="n">curr_item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">curr_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">curr_item</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">curr_item</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">curr_item</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">curr_item</span>
    
    <span class="n">meshes</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">meshes</span><span class="p">)</span>
    <span class="n">meshes_colors</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">meshes_colors</span><span class="p">)</span>
    <span class="n">skeletons</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">skeletons</span><span class="p">)</span>
    <span class="n">skeletons_colors</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">skeletons_colors</span><span class="p">)</span>
    <span class="n">scatters</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">scatters</span><span class="p">)</span>
    <span class="n">scatters_colors</span> <span class="o">=</span>  <span class="n">convert_to_list</span><span class="p">(</span><span class="n">scatters_colors</span><span class="p">)</span>
    
    <span class="c1"># --- 6/10: Making sure all scatters are numpy arrays ---</span>
    <span class="n">scatters</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scatters</span><span class="p">]</span>
    
    
    <span class="k">if</span> <span class="p">((</span><span class="n">subtract_from_main_mesh</span> <span class="ow">and</span> <span class="n">tu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">main_mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meshes</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)):</span>
        <span class="n">main_mesh</span> <span class="o">=</span> <span class="n">tu</span><span class="o">.</span><span class="n">subtract_mesh</span><span class="p">(</span><span class="n">original_mesh</span><span class="o">=</span><span class="n">main_mesh</span><span class="p">,</span>
                                  <span class="n">subtract_mesh</span><span class="o">=</span><span class="n">meshes</span><span class="p">,</span><span class="n">exact_match</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">main_mesh</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">main_mesh</span><span class="p">):</span>
        <span class="n">main_mesh_verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">main_mesh_faces</span><span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">main_mesh_verts</span> <span class="o">=</span> <span class="n">main_mesh</span><span class="o">.</span><span class="n">vertices</span>
        <span class="n">main_mesh_faces</span><span class="o">=</span> <span class="n">main_mesh</span><span class="o">.</span><span class="n">faces</span>
        
    <span class="k">if</span> <span class="n">main_mesh_alpha</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">main_mesh_alpha</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_array_like</span><span class="p">(</span><span class="n">main_mesh_color</span><span class="p">):</span>
            <span class="n">main_mesh_color</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">main_mesh_color</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_mesh_color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">main_mesh_color</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_mesh_alpha</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">main_mesh_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_mesh_alpha</span><span class="p">)</span>
            
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">main_mesh_color</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">main_mesh_color</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">color_to_rgba</span><span class="p">(</span><span class="n">main_mesh_color</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">main_mesh_alpha</span><span class="p">)</span>
    
    
    <span class="c1">#print(f&quot;scatters = {scatters}&quot;)</span>
    <span class="n">return_value</span> <span class="o">=</span> <span class="n">graph_skeleton_and_mesh</span><span class="p">(</span><span class="n">main_mesh_verts</span><span class="o">=</span><span class="n">main_mesh_verts</span><span class="p">,</span>
                           <span class="n">main_mesh_faces</span><span class="o">=</span><span class="n">main_mesh_faces</span><span class="p">,</span>
                           <span class="n">edge_coordinates</span><span class="o">=</span><span class="n">edge_coordinates</span><span class="p">,</span>
                           <span class="n">other_meshes</span><span class="o">=</span><span class="n">meshes</span><span class="p">,</span>
                                      <span class="n">mesh_alpha</span><span class="o">=</span><span class="n">mesh_alpha</span><span class="p">,</span>
                            <span class="n">other_meshes_colors</span><span class="o">=</span><span class="n">meshes_colors</span><span class="p">,</span>
                            <span class="n">other_skeletons</span><span class="o">=</span><span class="n">skeletons</span><span class="p">,</span>
                            <span class="n">other_skeletons_colors</span><span class="o">=</span><span class="n">skeletons_colors</span><span class="p">,</span>
                            <span class="n">other_scatter</span><span class="o">=</span><span class="n">scatters</span><span class="p">,</span>
                            <span class="n">other_scatter_colors</span><span class="o">=</span><span class="n">scatters_colors</span><span class="p">,</span>
                            <span class="n">scatter_size</span><span class="o">=</span><span class="n">scatter_size</span><span class="p">,</span>
                            <span class="n">main_scatter_color</span><span class="o">=</span><span class="n">main_scatter_color</span><span class="p">,</span>
                            <span class="n">scatter_with_widgets</span><span class="o">=</span><span class="n">scatter_with_widgets</span><span class="p">,</span>             
                                              
                            <span class="n">buffer</span><span class="o">=</span><span class="n">buffer</span><span class="p">,</span>
                            <span class="n">axis_box_off</span><span class="o">=</span><span class="n">axis_box_off</span><span class="p">,</span>
                            <span class="n">html_path</span><span class="o">=</span><span class="n">html_path</span><span class="p">,</span>
                            <span class="n">show_at_end</span><span class="o">=</span><span class="n">show_at_end</span><span class="p">,</span>
                            <span class="n">append_figure</span><span class="o">=</span><span class="n">append_figure</span><span class="p">,</span>
                            <span class="n">flip_y</span><span class="o">=</span><span class="n">flip_y</span><span class="p">,</span>
                                      <span class="n">main_mesh_color</span><span class="o">=</span><span class="n">main_mesh_color</span><span class="p">,</span>
                                    <span class="n">main_skeleton_color</span> <span class="o">=</span> <span class="n">main_skeleton_color</span><span class="p">,</span>
                                              
                            <span class="n">set_zoom</span><span class="o">=</span><span class="n">set_zoom</span><span class="p">,</span>
                            <span class="n">adaptive_min_max_limits</span><span class="o">=</span><span class="n">adaptive_min_max_limits</span><span class="p">,</span>
                           <span class="p">)</span>
    <span class="c1">#return </span>
    
    <span class="k">if</span> <span class="n">zoom_coordinate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to set zoom&quot;</span><span class="p">)</span>
        <span class="n">nviz</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span>
            <span class="n">zoom_coordinate</span><span class="p">,</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">zoom_radius</span><span class="p">,</span>
            <span class="n">radius_xyz</span> <span class="o">=</span> <span class="n">zoom_radius_xyz</span>
        <span class="p">)</span>
        
        
    <span class="k">return</span> <span class="n">return_value</span></div>
    
    
    
    



<span class="c1">#--- from python_tools ---</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">matplotlib_utils</span> <span class="k">as</span> <span class="n">mu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mesh_utils</span> <span class="k">as</span> <span class="n">mhu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">numpy_utils</span> <span class="k">as</span> <span class="n">nu</span>

<span class="c1">#--- from mesh_tools ---</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mesh_tools</span> <span class="kn">import</span> <span class="n">trimesh_utils</span> <span class="k">as</span> <span class="n">tu</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">tu</span> <span class="o">=</span> <span class="kc">None</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">ipyvolume_utils</span> <span class="k">as</span> <span class="n">ipvu</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Brendan Celii.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>